/*!
 * Ext JS Library 3.2.1
 * Copyright(c) 2006-2010 Ext JS, Inc.
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.UpdateManager.defaults.indicatorText='<div class="loading-indicator">加载中...</div>';if(Ext.DataView){Ext.DataView.prototype.emptyText=""}if(Ext.grid.GridPanel){Ext.grid.GridPanel.prototype.ddText="选择了 {0} 行"}if(Ext.TabPanelItem){Ext.TabPanelItem.prototype.closeText="关闭此标签"}if(Ext.form.Field){Ext.form.Field.prototype.invalidText="输入值非法"}if(Ext.LoadMask){Ext.LoadMask.prototype.msg="读取中..."}Date.monthNames=["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"];Date.dayNames=["日","一","二","三","四","五","六"];Date.formatCodes.a="(this.getHours() < 12 ? '上午' : '下午')";Date.formatCodes.A="(this.getHours() < 12 ? '上午' : '下午')";if(Ext.MessageBox){Ext.MessageBox.buttonText={ok:"确定",cancel:"取消",yes:"是",no:"否"}}if(Ext.util.Format){Ext.util.Format.date=function(a,b){if(!a){return""}if(!(a instanceof Date)){a=new Date(Date.parse(a))}return a.dateFormat(b||"y年m月d日")}}if(Ext.DatePicker){Ext.apply(Ext.DatePicker.prototype,{todayText:"今天",minText:"日期必须大于最小允许日期",maxText:"日期必须小于最大允许日期",disabledDaysText:"",disabledDatesText:"",monthNames:Date.monthNames,dayNames:Date.dayNames,nextText:"下个月 (Ctrl+Right)",prevText:"上个月 (Ctrl+Left)",monthYearText:"选择一个月 (Control+Up/Down 来改变年份)",todayTip:"{0} (空格键选择)",format:"y年m月d日",okText:"确定",cancelText:"取消"})}if(Ext.PagingToolbar){Ext.apply(Ext.PagingToolbar.prototype,{beforePageText:"第",afterPageText:"页,共 {0} 页",firstText:"第一页",prevText:"上一页",nextText:"下一页",lastText:"最后页",refreshText:"刷新",displayMsg:"显示 {0} - {1}条，共 {2} 条",emptyMsg:"没有数据"})}if(Ext.form.TextField){Ext.apply(Ext.form.TextField.prototype,{minLengthText:"该输入项的最小长度是 {0} 个字符",maxLengthText:"该输入项的最大长度是 {0} 个字符",blankText:"该输入项为必输项",regexText:"",emptyText:null})}if(Ext.form.NumberField){Ext.apply(Ext.form.NumberField.prototype,{minText:"该输入项的最小值是 {0}",maxText:"该输入项的最大值是 {0}",nanText:"{0} 不是有效数值"})}if(Ext.form.DateField){Ext.apply(Ext.form.DateField.prototype,{disabledDaysText:"禁用",disabledDatesText:"禁用",minText:"该输入项的日期必须在 {0} 之后",maxText:"该输入项的日期必须在 {0} 之前",invalidText:"{0} 是无效的日期 - 必须符合格式： {1}",format:"y年m月d日"})}if(Ext.form.ComboBox){Ext.apply(Ext.form.ComboBox.prototype,{loadingText:"加载中...",valueNotFoundText:undefined})}if(Ext.form.VTypes){Ext.apply(Ext.form.VTypes,{emailText:'该输入项必须是电子邮件地址，格式如： "user@example.com"',urlText:'该输入项必须是URL地址，格式如： "http://www.example.com"',alphaText:"该输入项只能包含半角字母和_",alphanumText:"该输入项只能包含半角字母,数字和_"})}if(Ext.form.HtmlEditor){Ext.apply(Ext.form.HtmlEditor.prototype,{createLinkText:"添加超级链接:",buttonTips:{bold:{title:"粗体 (Ctrl+B)",text:"将选中的文字设置为粗体",cls:"x-html-editor-tip"},italic:{title:"斜体 (Ctrl+I)",text:"将选中的文字设置为斜体",cls:"x-html-editor-tip"},underline:{title:"下划线 (Ctrl+U)",text:"给所选文字加下划线",cls:"x-html-editor-tip"},increasefontsize:{title:"增大字体",text:"增大字号",cls:"x-html-editor-tip"},decreasefontsize:{title:"缩小字体",text:"减小字号",cls:"x-html-editor-tip"},backcolor:{title:"以不同颜色突出显示文本",text:"使文字看上去像是用荧光笔做了标记一样",cls:"x-html-editor-tip"},forecolor:{title:"字体颜色",text:"更改字体颜色",cls:"x-html-editor-tip"},justifyleft:{title:"左对齐",text:"将文字左对齐",cls:"x-html-editor-tip"},justifycenter:{title:"居中",text:"将文字居中对齐",cls:"x-html-editor-tip"},justifyright:{title:"右对齐",text:"将文字右对齐",cls:"x-html-editor-tip"},insertunorderedlist:{title:"项目符号",text:"开始创建项目符号列表",cls:"x-html-editor-tip"},insertorderedlist:{title:"编号",text:"开始创建编号列表",cls:"x-html-editor-tip"},createlink:{title:"转成超级链接",text:"将所选文本转换成超级链接",cls:"x-html-editor-tip"},sourceedit:{title:"代码视图",text:"以代码的形式展现文本",cls:"x-html-editor-tip"}}})}if(Ext.grid.GridView){Ext.apply(Ext.grid.GridView.prototype,{sortAscText:"正序",sortDescText:"倒序",lockText:"锁定列",unlockText:"解除锁定",columnsText:"列"})}if(Ext.grid.PropertyColumnModel){Ext.apply(Ext.grid.PropertyColumnModel.prototype,{nameText:"名称",valueText:"值",dateFormat:"y年m月d日"})}if(Ext.layout.BorderLayout&&Ext.layout.BorderLayout.SplitRegion){Ext.apply(Ext.layout.BorderLayout.SplitRegion.prototype,{splitTip:"拖动来改变尺寸.",collapsibleSplitTip:"拖动来改变尺寸. 双击隐藏."})}var G_xmlNode_root="root";var G_xmlNode_rtn="rtn";var G_xmlNode_msg="msg";function PostInfoXml(e,f){var d=callXMLHTTP(e,f);if(d.indexOf(G_xmlNode_root)>=0){var c=loadXMLString(d);if(c==null){return null}var a=c.documentElement;if(d.indexOf(G_xmlNode_rtn)>=0){var b=a.getElementsByTagName(G_xmlNode_rtn);if(getXmlNodeValue(b[0])==-1){alert(decodeURIComponent(getXmlNodeValue((a.getElementsByTagName(G_xmlNode_msg))[0])));return null}}return a}else{alert("返回的数据不符合xml格式");return null}}function getXmlNodeValue(a){if(a.firstChild){return a.firstChild.data}else{return a.nodeValue}}function callXMLHTTP(b,c){if(b.indexOf("?")>=0){b=b+"&url_source=XMLHTTP"}else{b=b+"?url_source=XMLHTTP"}var a=newXMLHTTP();if(a==null){return"<"+G_xmlNode_root+"><"+G_xmlNode_rtn+">-1</"+G_xmlNode_rtn+"><"+G_xmlNode_msg+">不能建立XMLHTTP对象</"+G_xmlNode_msg+"></"+G_xmlNode_root+">"}a.open("POST",encodeAppUrl(b),false);a.setRequestHeader("Content-Type","application/x-www-form-urlencoded");a.send(c);if(a.status!=200){return"<"+G_xmlNode_root+"><"+G_xmlNode_rtn+">-1</"+G_xmlNode_rtn+"><"+G_xmlNode_msg+">URL请求失败，请确认服务器是否正常(或连接是否正确).</"+G_xmlNode_msg+"></"+G_xmlNode_root+">"}else{return a.responseText}}function newXMLHTTP(){var c=null;var a=new Array("Microsoft.XMLHTTP");if(window.XMLHttpRequest){return new XMLHttpRequest()}else{if(window.ActiveXObject){for(var b=0;b<a.length;b++){try{return new ActiveXObject(a[b])}catch(d){c=null}}}else{return null}}}function loadXMLString(d){if(document.implementation&&document.implementation.createDocument){var f=new DOMParser();var c=null;try{c=f.parseFromString(d,"text/xml")}catch(b){}if(c==null){alert("无法创建XMLDOM对象");return c}if(c.documentElement.nodeName=="parsererror"){alert("XML字符串加载失败!");return null}return c}else{if(window.ActiveXObject){var a=new ActiveXObject("Microsoft.XMLDOM");a.async=false;l=a.loadXML(d);if(!l){alert("XML字符串加载失败!");return null}return a}else{alert("Your browser can't handle this script");return null}}}function loadXmlFile(b){var a;if(document.implementation&&document.implementation.createDocument){a=document.implementation.createDocument("","",null);a.async=false}else{if(window.ActiveXObject){a=new ActiveXObject("Microsoft.XMLDOM");a.async=false}else{alert("无法创建XMLDOM对象");return null}}l=a.load(b);if(!l){alert("XML文件加载失败!");return null}else{return a}}function encodeAppUrl(f){var a=f.split("?");var g="1=1";if(a.length>1){var d=(a[1]).split("&");for(var b=0;b<d.length;b++){var e=d[b].split("=");if(e[0].length==1){g+="&"+e[0]+"="}else{if(e[0].length>1){g+="&"+e[0]+"="+encodeURIComponent(e[1])}}}}var c=a[0]+"?"+g;return c}function callXMLHTTPJson(b,c){if(b.indexOf("?")>=0){b=b+"&url_source=XMLHTTP"}else{b=b+"?url_source=XMLHTTP"}var a=newXMLHTTP();if(a==null){return"{"+G_xmlNode_rtn+":-1,"+G_xmlNode_msg+":'不能建立XMLHTTP对象'}"}a.open("POST",encodeAppUrl(b),false);a.setRequestHeader("Content-Type","application/x-www-form-urlencoded");a.send(c);if(a.status!=200){return"{"+G_xmlNode_rtn+":-1,"+G_xmlNode_msg+":'URL请求失败，请确认服务器是否正常(或连接是否正确).'}"}else{return a.responseText}}function PostInfoJson(a){return PostInfoJson(a,null)}function PostInfoJson(strUrl,strXML){var strResponse=callXMLHTTPJson(strUrl,strXML);try{eval("var jsonObj ="+strResponse);if(strResponse.indexOf(G_xmlNode_rtn+":")>=0){eval("var rtn=jsonObj."+G_xmlNode_rtn);eval("var msg=jsonObj."+G_xmlNode_msg);if(rtn==-1){alert(decodeURIComponent(msg));return null}}return jsonObj}catch(ex){alert("返回的数据不符合json格式");return null}}function PostFormInfoJson(c,b){var a=c;if(a.indexOf("?")>=0){a=a+"&"+genUrlParam(b)}else{a=a+"?"+genUrlParam(b)}return PostInfoJson(a,null)}function PostFormInfoJson(d,c,a){var b=d;if(b.indexOf("?")>=0){b=b+"&"+genUrlParam(c)}else{b=b+"?"+genUrlParam(c)}return PostInfoJson(b,a)}function genUrlParam(d){var a=document.getElementById(d);var c="1=1";for(i=0;i<a.elements.length;i++){var b=a.elements[i];if(typeof b.name!="undefined"&&typeof b.type!="undefined"&&typeof b.value!="undefined"){c+="&"+b.name+"="+b.value}}return c}function initFormJson(strUrl,strFormId){var rtnObj=PostInfoJson(strUrl,null);if(rtnObj!=null&&rtnObj.rtn=="0"){eval("var jsonObj="+rtnObj.msg);setFormValue(strFormId,jsonObj)}}function setFormValue(strFormId,jsonObj){var theform=document.getElementById(strFormId);for(i=0;i<theform.elements.length;i++){var e=theform.elements[i];if(typeof e.name!="undefined"&&typeof e.type!="undefined"&&typeof e.value!="undefined"){var setStr=" if(typeof jsonObj."+e.name+"!='undefined'){";setStr+=" e.value=jsonObj."+e.name+";";setStr+=" }";eval(setStr)}}}Ext.apply(Ext.form.VTypes,{password:function(c,b){if(b.confirmTo){var a=Ext.get(b.confirmTo);if(c.trim()==a.getValue().trim()){return true}else{return false}return false}},passwordText:"两次输入的密码不一致！",chinese:function(c,b){var a=/^[\u4e00-\u9fa5]+$/i;if(!a.test(c)){return false}return true},chineseText:"请输入中文",age:function(c,b){try{if(parseInt(c)>=18&&parseInt(c)<=100){return true}return false}catch(a){return false}},ageText:"年龄输入有误",alphanum:function(c,b){try{if(!/\W/.test(c)){return true}return false}catch(a){return false}},alphanumText:"请输入英文字母或是数字,其它字符是不允许的.",http:function(c,b){try{if(/^(http|https|ftp):\/\/(([A-Z0-9][A-Z0-9_-]*)(\.[A-Z0-9][A-Z0-9_-]*)+)(:(\d+))?\/?/i.test(c)){return true}return false}catch(a){return false}},urlText:"请输入有效的URL地址.",max:function(c,b){try{if(parseFloat(c)<=parseFloat(b.max)){return true}return false}catch(a){return false}},maxText:"超过最大值",min:function(c,b){try{if(parseFloat(c)>=parseFloat(b.min)){return true}return false}catch(a){return false}},minText:"小于最小值",datecn:function(g,c){try{var a=/^(\d{4})-(\d{2})-(\d{2})$/;if(!a.test(g)){return false}var f=new Date(g.replace(a,"$1/$2/$3"));return(parseInt(RegExp.$2,10)==(1+f.getMonth()))&&(parseInt(RegExp.$3,10)==f.getDate())&&(parseInt(RegExp.$1,10)==f.getFullYear())}catch(b){return false}},datecnText:"请使用这样的日期格式: yyyy-mm-dd. 例如:2008-06-20.",integer:function(c,b){try{if(/^[-+]?[\d]+$/.test(c)){return true}return false}catch(a){return false}},integerText:"请输入正确的整数",minlength:function(c,b){try{if(c.length>=parseInt(b.minlen)){return true}return false}catch(a){return false}},minlengthText:"长度过小",maxlength:function(c,b){try{if(c.length<=parseInt(b.maxlen)){return true}return false}catch(a){return false}},maxlengthText:"长度过大",ip:function(c,b){try{if((/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/.test(c))){return true}return false}catch(a){return false}},ipText:"请输入正确的IP地址",phone:function(c,b){try{if(/^((0[1-9]{3})?(0[12][0-9])?[-])?\d{6,8}$/.test(c)){return true}return false}catch(a){return false}},phoneText:"请输入正确的电话号码,如:0920-29392929",mobilephone:function(c,b){try{if(/(^0?[1][35][0-9]{9}$)/.test(c)){return true}return false}catch(a){return false}},mobilephoneText:"请输入正确的手机号码",alpha:function(c,b){try{if(/^[a-zA-Z]+$/.test(c)){return true}return false}catch(a){return false}},alphaText:"请输入英文字母"});Ext.namespace("Com","Com.panel");Ext.namespace("Ext.ux");Ext.ux.ZuheBox=Ext.extend(Ext.form.ComboBox,{isAutoLoad:false,subPnl:null,subHeight:200,subType:"tree",clearFun:function(){this.setValue("");this.setRawValue("");if(this.hiddenField){this.hiddenField.value=""}this.collapse()},initComponent:function(){this.boxType="1";if(!this.listWidth){this.listWidth=260}this.store=new Ext.data.SimpleStore({fields:[],data:[[]]}),this.tpl=new Ext.XTemplate('<div id="'+this.id+'DivId"></div>');this.forceSelection=true;this.triggerAction="all";this.typeAhead=true;this.mode="local";this.borderPnl=new Ext.Panel({layout:"fit",border:false,frame:false,height:200,items:this.subPnl,tbar:[{xtype:"button",text:"清空",width:40,scope:this,handler:this.clearFun}]});this.on("expand",function(){this.borderPnl.render(this.id+"DivId")});this.on("collapse",function(){this.focus(false,100)});Ext.ux.BaseTreeBox.superclass.initComponent.call(this)},onKeyUp:function(d){if(!this.isExpanded()){this.onTriggerClick(d)}var b=this.borderPnl.items.items[0];var c=b.getSelectionModel();if(c.selNode==null){var a=b.getNodeById((b.getRootNode()).id);a.select()}else{c.select(c.selNode,d)}c.box=this;c.onKeyDown(d)}});Ext.reg("zuheBox",Ext.ux.ZuheBox);Ext.namespace("Ext.ux");Ext.ux.BasePageGrid=Ext.extend(Ext.grid.GridPanel,{queryUrl:"",pkField:"",colArr:[],colTitleArr:[],remoteSort:false,isSel:true,isSingleSel:true,isPage:true,isShowRowNum:false,vMethod:"POST",initComponent:function(){if(this.queryUrl==null||(this.queryUrl).length==0){alert("表格数据连接地址没有设置")}var v_colArr=this.colArr;var v_colTitleArr=this.colTitleArr;if(this.isPage){this.buildPageStore()}else{this.buildStore()}var v_colTitle=[];if(!this.isSel){v_colTitle=v_colTitleArr}else{if(this.isShowRowNum){v_colTitle[v_colTitle.length]=new Ext.grid.RowNumberer({width:30})}var smCol=new Ext.grid.CheckboxSelectionModel({singleSelect:this.isSingleSel,grid:this});v_colTitle[v_colTitle.length]=smCol;for(var z=0;z<v_colTitleArr.length;z++){v_colTitle[v_colTitle.length]=v_colTitleArr[z]}if(!this.isSingleSel){this.sm=smCol}}this.columns=v_colTitle;this.store.on("exception",function(dataProxy,type,action,options,response,arg){try{var jsonObj=eval("("+response.responseText+")");top.Ext.MessageBox.alert("提示",jsonObj.msg)}catch(ex){top.Ext.MessageBox.alert("提示",response.responseText)}});Ext.ux.BasePageGrid.superclass.initComponent.call(this)},buildStore:function(){this.store=new Ext.data.JsonStore({root:"data",idProperty:this.pkField,remoteSort:this.remoteSort,proxy:new Ext.data.HttpProxy({url:this.queryUrl,method:this.vMethod}),fields:this.colArr})},buildPageStore:function(){this.store=new Ext.data.JsonStore({root:"data",totalProperty:"pageInfo.rowCount",idProperty:this.pkField,remoteSort:this.remoteSort,proxy:new Ext.data.HttpProxy({url:this.queryUrl,method:this.vMethod}),fields:this.colArr});this.bbar=new Ext.PagingToolbar({pageSize:g_grid_pageSize,store:this.store,beforePageText:"当前第",afterPageText:"页，共{0}页",lastText:"尾页",nextText:"下一页",prevText:"上一页",firstText:"首页",refreshText:"刷新页面",displayInfo:true,displayMsg:"共{2}条记录",emptyMsg:"没有记录"})},queryData:function(a){this.store.baseParams=a;this.store.load({params:{start:0,limit:g_grid_pageSize}})}});Ext.namespace("Ext.ux");Ext.ux.BaseForm=Ext.extend(Ext.form.FormPanel,{focusFieldId:null,initComponent:function(){this.frame=false;this.border=false;this.bodyStyle=this.bodyStyle==null?"padding-top:6px;padding-bottom:0px;padding-right:6px":this.bodyStyle;this.reader=this.getReader();this.items=this.getItems();this.buttons=this.buildButtons();this.buttonAlign=this.getButtonAlign();this.on("render",function(b){if(this.focusFieldId!=null){var a=b.findById(this.focusFieldId);if(a!=null){a.focus(false,100)}}});Ext.ux.BaseForm.superclass.initComponent.call(this)},getReader:function(){return new Ext.data.JsonReader({root:"data",successProperty:"success"})},gridRecToForm:function(g){var a=Ext.getCmp(this.id).getForm();var f=a.items.keys;for(var d=0;d<f.length;d++){var c=Ext.getCmp(f[d]);var b=(f[d]).replace("Ed","");b=b.replace("Txt","");var e=g.get(b);if(typeof e!="undefined"&&(e+"").length>0){c.setValue(e)}}},gridKeyToForm:function(e){var c=e.data;for(var b in c){var d=c[b];var a=Ext.getCmp(b);if(a==null||typeof a=="undefined"){a=Ext.getCmp(b+"Ed")}else{a.setValue(d);continue}if(a==null||typeof a=="undefined"){a=Ext.getCmp(b+"Txt")}else{a.setValue(d);continue}if(a==null||typeof a=="undefined"){a=Ext.getCmp(b+"Ed1")}else{a.setValue(d);continue}if(a!=null&&typeof a!="undefined"){a.setValue(d)}}},getItems:function(){return[]},buildButtons:function(){return[]},getButtonAlign:function(){return"right"},onDestroy:function(){Ext.destroy(this.reader);delete this.v_items;delete this.v_FormMapp;delete this.frame;delete this.bodyStyle;delete this.waitMsgTarget;delete this.style;delete this.reader;Ext.ux.BaseForm.superclass.onDestroy.call(this)}});Ext.reg("singleFormPanel",Ext.ux.BaseForm);Ext.namespace("Ext.ux");Ext.ux.BaseGird=Ext.extend(Ext.ux.BasePageGrid,{isShow:false,initComponent:function(){this.border=false;this.frame=false;this.pkField=this.getPkField();this.queryUrl=this.getQryUrl();this.colArr=this.getCol();this.colTitleArr=this.getColTitle();if(!this.isShow&&(this.tbar==null||(this.tbar).length==0)){this.tbar=this.buildToolBar()}Ext.ux.BaseGird.superclass.initComponent.call(this)},getOneSel:function(){var a=this.getSelectionModel().getSelections();if(a.length==0){top.Ext.Msg.alert("提示信息","请您至少选择一条记录.");return null}else{if(a.length>1){top.Ext.Msg.alert("提示信息","只能选择一条记录.");return null}else{return a[0]}}},getSel:function(){var a=this.getSelectionModel().getSelections();if(a.length==0){top.Ext.Msg.alert("提示信息","请您至少选择一条记录.");return null}else{return a}},buildToolBar:function(){return[]},getCol:function(){return[]},getColTitle:function(){return[]},getQryUrl:function(){return""},getPkField:function(){return""}});Ext.reg("baseGrid",Ext.ux.BaseGird);Ext.override(Ext.form.ComboBox,{onKeyUp:function(b){if(this.editable!==false&&!b.isSpecialKey()){if(!this.isExpanded()){this.onTriggerClick()}try{var a=this.store.find(this.displayField,this.getRawValue(),0,true);if(a!==-1){this.select(this.store.getCount()-1);this.select(a,true)}else{this.select(0,true)}}catch(b){}}},setValue:function(a){var c=a;if(this.valueField){var b=this.findRecord2(this.valueField,a);if(b){c=b.data[this.displayField]}else{if(this.valueNotFoundText!==undefined){c=this.valueNotFoundText}}}this.lastSelectionText=c;if(this.hiddenField){this.hiddenField.value=a}Ext.form.ComboBox.superclass.setValue.call(this,c);this.value=a},findRecord2:function(c,e){var a=this.store.getCount();for(var b=0;b<a;b++){var d=this.store.getAt(b);if(Ext.util.Format.trim(d.get(c))==Ext.util.Format.trim(e)){return d}}}});Ext.ux.BaseComBox=Ext.extend(Ext.form.ComboBox,{rootPath:"",optionKey:"",jsonData:[],initComponent:function(){if(this.valueField==undefined){this.valueField="value"}if(this.displayField==undefined){this.displayField="text"}this.triggerAction="all";this.anchor="100%";this.editable=true;if(this.localArrData()!=null){this.dataArray=this.localArrData();this.localArrayStore()}else{if(this.localJsonData()!=null){this.jsonData=this.localJsonData();this.localJsonStore()}else{this.remoteStore()}}if(this.blankText==null){this.blankText="请选择"}if(this.emptyText==null){this.emptyText="请选择"}if(this.getEvents()!=null){this.listeners=this.getEvents()}var a=function(b){if(this.getRawValue()==""){this.clearValue()}};if(this.listeners!=null){this.listeners.blur=a}else{this.listeners={};this.listeners.blur=a}Ext.ux.BaseComBox.superclass.initComponent.call(this)},assertValue:function(){return false},localArrayStore:function(){this.mode="local";this.store=new Ext.data.ArrayStore({data:this.dataArray,fields:["value","text"]})},localJsonStore:function(){this.mode="local";this.store=new Ext.data.ArrayStore({data:this.jsonData,fields:[{name:"value",mapping:"value"},{name:"text",mapping:"text"}]})},remoteStore:function(){this.mode="remote";this.store=new Ext.data.JsonStore({root:"data",url:this.remoteUrl(),fields:["value","text","otherValue"],idProperty:"value"})},remoteUrl:function(){return this.rootPath+"/optionWeb.cll?method=queryOption&optionNo="+this.optionKey},localArrData:function(){return null},localJsonData:function(){if((this.jsonData).length==0){return null}else{return this.jsonData}},getEvents:function(){return null},getStoreEvent:function(){return null}});Ext.reg("baseComBox",Ext.ux.BaseComBox);Ext.namespace("Ext.ux");Ext.ux.BaseGridBox=Ext.extend(Ext.form.ComboBox,{filterVal:"",filterVal2:"",fltDefaultVal:"",filterFldName:"",topFlg:false,isExpandQry:true,isSingleSel:true,resetFlg:true,selFun:function(){},onKeyUp:function(a){Ext.form.ComboBox.superclass.onKeyUp.call(this,a)},initComponent:function(){this.boxType="1";this.enableKeyEvents=true;this.editable=true;this.typeAhead=true;this.region="center";this.store=new Ext.data.SimpleStore({fields:[],data:[[]]}),this.tpl=new Ext.XTemplate('<div id="'+this.id+'GridDivId"></div>');this.forceSelection=true;this.triggerAction="all";this.typeAhead=true;this.mode="local";this.initFlg=false;if(this.listWidth==null){this.listWidth=360}var a=[{width:50,scope:this,text:"清 空",scope:this,handler:function(){this.gridPnl.getSelectionModel().clearSelections(false);this.setValue("");this.setRawValue("");h="";if(this.hiddenField){this.hiddenField.value=""}this.clearOther();this.keyWordQry(false)}}];var h="";var e=function(j,m,k){this.gridDblClick(j,m,k);h=this.getRawValue()};var f={scope:this,rowdblclick:e};if(!this.isSingleSel){f={};a[a.length]={scope:this,text:"确   定",handler:this.selFun}}var d=this.getCol();d.push({name:"userViewId"});this.gridPnl=new Ext.ux.BasePageGrid({region:"center",id:this.id+"GridId",colArr:d,colTitleArr:this.getColTitle(),queryUrl:this.getQryUrl(),pkField:this.getPkField(),border:false,frame:false,layout:"fit",isSingleSel:this.isSingleSel,listeners:f});var g=this;var c=this.gridPnl.getSelectionModel();c.on("rowselect",function(k,m,j){g.focus(false,100)});c.on("rowdeselect",function(k,m,j){g.focus(false,100)});c.on("selectionchange",function(j){g.focus(false,100)});var b=this.gridPnl.getView();b.focusCell=function(k,j,m){this.syncFocusEl(this.ensureVisible(k,j,m))};this.borderPnl=new Ext.Panel({layout:"fit",border:false,height:200,tbar:a,items:this.gridPnl});this.on("expand",function(){this.borderPnl.render(this.id+"GridDivId");if(this.isExpandQry){this.keyWordQry(false)}this.initFlg=true;this.lastrownum1=0});Ext.ux.BaseGridBox.superclass.initComponent.call(this)},lastrownum1:0,onKeyUp:function(f){var c=this.gridPnl;var b=f.getKey();var a=c.getView();if(b==f.UP){if(this.lastrownum1==0){a.focusRow(0);this.lastrownum1=0;c.getSelectionModel().selectRow(this.lastrownum1)}else{this.lastrownum1=this.lastrownum1-1;a.focusRow(this.lastrownum1);c.getSelectionModel().selectRow(this.lastrownum1)}}else{if(b==f.DOWN){if(this.lastrownum1==(c.getStore().getCount()-1)){this.lastrownum1=c.getStore().getCount()-1;a.focusRow(this.lastrownum1);c.getSelectionModel().selectRow(this.lastrownum1)}else{this.lastrownum1=this.lastrownum1+1;a.focusRow(this.lastrownum1);c.getSelectionModel().selectRow(this.lastrownum1)}}else{if(b==f.ENTER){if(!this.isSingleSel){if(this.selFun!=null){this.selFun()}}else{if(c.getSelectionModel().getCount()==1){var d=(this.gridPnl.getSelectionModel().getSelections())[0];this.gridDblClick(this.gridPnl,this.gridPnl.store.indexOf(d),f)}}}else{if((this.getRawValue()).length==0){this.setValue("");this.setRawValue("");if(this.hiddenField){this.hiddenField.value=""}}if(!this.isExpanded()){this.onTriggerClick(f)}else{setTimeout(this.keyWordQry.createDelegate(this,[true]),500)}}}}},assertValue:function(){return false},keyWordQry:function(a){if(this.filterFldName!=""){var d;if(this.topFlg){d=top.Ext.getCmp(this.filterFldName)}else{d=Ext.getCmp(this.filterFldName)}if(d.hiddenField){this.filterVal=d.hiddenField.value}else{this.filterVal=d.getValue()}if((this.filterVal).length==0){this.filterVal=this.fltDefaultVal}}this.gridPnl.store.removeAll();var c=this.gridPnl.store.baseParams;c.keyWord=this.getRawValue();c.filterVal=this.filterVal;c.filterVal2=this.filterVal2;this.gridPnl.store.baseParams=c;var b=this;this.gridPnl.store.load({params:{start:0,limit:g_grid_pageSize},callback:function(j,g,k){if(k){for(var h=0;h<j.length;h++){var e=j[h];var f=e.data.userViewId;if(f==null||f==""){e.set("userViewId",1)}}if(j.length>0){b.lastrownum1=0;b.gridPnl.getSelectionModel().selectRow(0)}}}})},clearOther:function(){},setVal:function(b,a){this.setValue(b);this.setRawValue(a);if(this.hiddenField){this.hiddenField.value=b}},getGridPnl:function(){return this.gridPnl},gridDblClick:function(a,c,b){},getCol:function(){return[]},getColTitle:function(){return[]},getQryUrl:function(){return""},getPkField:function(){return""}});Ext.reg("baseGridBox",Ext.ux.BaseGridBox);Ext.namespace("Ext.ux");Ext.ux.BaseTree=Ext.extend(Ext.tree.TreePanel,{boxFlg:null,initComponent:function(){this.autoLoad=false;this.useArrows=false;this.autoScroll=true;this.animate=false;this.enableDD=false;this.containerScroll=false;this.loader=this.getTreeLoader();this.root=this.getRootNode();if(!(this.getTbar()==null||(this.getTbar()).length==0)){this.tbar=this.getTbar()}this.listeners=this.getEventList();Ext.ux.BaseTree.superclass.initComponent.call(this)},refreshTree:function(){var a=this.getSelectionModel().getSelectedNode();if(a==null){a=this.root}if(a!=null){a.eachChild(function(b){if(typeof b!="undefined"){b.remove()}});this.loader.load(a,function(){a.expand()})}},assertValue:function(){return false},delSelNode:function(){var b=this.getSelectionModel().getSelectedNode();var a=b.parentNode;b.remove();if(a!=null){this.reloadNode(a)}},reloadNode:function(a){a.eachChild(function(b){if(typeof b!="undefined"){b.remove()}});this.loader.load(a,function(){a.expand()})},reloadSelNode:function(){var a=this.getSelectionModel().getSelectedNode();if(a!=null){a.eachChild(function(b){if(typeof b!="undefined"){b.remove()}});this.loader.load(a,function(){a.expand()})}},selNodeHasChild:function(){var a=this.getSelectionModel().getSelectedNode();return a.hasChildNodes()},setSelNodeTxt:function(a){var b=this.getSelectionModel().getSelectedNode();b.setText(a)},getRootNode:function(){return{nodeType:"async",text:"根目录",draggable:false,id:"0"}},getTreeLoader:function(){return null},getEventList:function(){if(this.boxFlg==null){return{expandnode:function(a){a.select();this.nodeExClick(a)},collapsenode:function(a){a.select();this.nodeExClick(a)},click:function(a,b){if(!a.isExpanded()){a.expand()}else{this.nodeExClick(a)}}}}else{return{expandnode:function(a){a.select()},collapsenode:function(a){a.select()},click:function(a,b){if(!a.isExpanded()){a.expand()}},dblclick:function(a,b){this.nodeExClick(a)}}}},getTbar:function(){return[]}});Ext.namespace("Ext.ux");Ext.override(Ext.tree.DefaultSelectionModel,{box:null,onKeyDown:function(j){var e=this.selNode||this.lastSelNode;var h=this;if(!e){return}var f=j.getKey();switch(f){case j.DOWN:j.stopEvent();this.selectNext();break;case j.UP:j.stopEvent();this.selectPrevious();break;case j.RIGHT:j.preventDefault();if(e.hasChildNodes()){if(!e.isExpanded()){e.expand()}else{if(e.firstChild){this.select(e.firstChild,j)}}}break;case j.LEFT:j.preventDefault();if(e.hasChildNodes()&&e.isExpanded()){e.collapse()}else{if(e.parentNode&&(this.tree.rootVisible||e.parentNode!=this.tree.getRootNode())){this.select(e.parentNode,j)}}break;case j.ENTER:j.stopEvent();try{if(this.box!=null){this.box.nodeDblClick(this.selNode)}}catch(g){}try{this.tree.nodeExClick(this.selNode)}catch(g){}if(this.box!=null){this.box.focus();this.box.collapse()}break;case j.TAB:j.stopEvent();if(this.box!=null){this.box.focus();this.box.collapse()}break;case j.ESC:j.stopEvent();if(this.box!=null){this.box.focus();this.box.collapse()}break}},select:function(f,e){if(!Ext.fly(f.ui.wrap).isVisible()&&e){return e.call(this,f)}var d=this.selNode;if(f==d){f.ui.onSelectedChange(true)}else{if(this.fireEvent("beforeselect",this,f,d)!==false){if(d&&d.ui){d.ui.onSelectedChange(false)}this.selNode=f;f.ui.onSelectedChange(true);this.fireEvent("selectionchange",this,f,d)}}return f}});Ext.tree.MyTreeNode=function(b){this.wasLeaf=false;Ext.tree.MyTreeNode.superclass.constructor.apply(this,arguments)};Ext.extend(Ext.tree.MyTreeNode,Ext.tree.TreeNode,{isLast:function(){var a=false;if(!this.attributes.hadLoad){a=false}else{a=(!this.parentNode?true:this.parentNode.lastChild==this)}return a},hasChildNodes:function(){if(!this.attributes.hadLoad){return true}else{return Ext.tree.MyTreeNode.superclass.hasChildNodes.call(this)}},expand:function(a,f,d,g){if(!this.attributes.hadLoad){if(this.fireEvent("click",this,a,f)===false){return}}Ext.tree.MyTreeNode.superclass.expand.call(this,a,f,d,g)}});Ext.ux.BaseTreeBox=Ext.extend(Ext.form.ComboBox,{isAutoLoad:false,refreshTree:function(){var a=this.rootNode;a.eachChild(function(b){if(typeof b!="undefined"){b.remove()}});this.loadSubNode(a)},initComponent:function(){this.boxType="1";this.border=false;this.frame=true;this.region="center";if(!this.listWidth){this.listWidth=260}this.store=new Ext.data.SimpleStore({fields:[],data:[[]]}),this.tpl=new Ext.XTemplate('<div id="'+this.id+'DivId"></div>');this.forceSelection=true;this.triggerAction="all";this.typeAhead=true;this.mode="local";this.treeUrl=this.getTreeUrl();this.rootNode=this.getRootNode();this.treePnl=new Ext.tree.TreePanel({border:false,rootVisible:false,root:this.rootNode,height:200,autoScroll:true,tbar:[{xtype:"button",text:"清空",width:40,scope:this,handler:function(){this.setValue("");this.setRawValue("");if(this.hiddenField){this.hiddenField.value=""}this.collapse()}}]});new Ext.tree.TreeSorter(this.treePnl,{folderSort:true});this.treeHadLoad=false;this.borderTreePnl=new Ext.Panel({layout:"fit",border:false,height:200,items:this.treePnl});this.on("expand",function(){this.borderTreePnl.render(this.id+"DivId");if(!this.treeHadLoad){this.loadSubNode(this.rootNode);this.treeHadLoad=true}});this.on("collapse",function(){this.focus(false,100)});Ext.ux.BaseTreeBox.superclass.initComponent.call(this)},onKeyUp:function(c){if(!this.isExpanded()){this.onTriggerClick(c)}var b=this.treePnl.getSelectionModel();if(b.selNode==null){var a=this.treePnl.getNodeById((this.treePnl.getRootNode()).id);a.select()}else{b.select(b.selNode,c)}b.box=this;b.onKeyDown(c)},assertValue:function(){return false},nodeClick:function(a){if(!a.attributes.hadLoad){this.loadSubNode(a);a.attributes.hadLoad=true;a.ui.updateExpandIcon()}if(!a.isExpanded()){a.expand()}return true},loadSubNode:function(b){var c=b.id;var a=null;if(this.treeUrl!=null){Ext.Ajax.request({url:this.treeUrl+"&parentId="+c,scope:this,success:function(d){var e=Ext.decode(d.responseText);this.buildSubNode(e.data)},failure:function(d){g_showTip("提示","获取树型数据失败",Ext.MessageBox.ERROR)}})}else{top.Ext.Msg.alert("提示","获取树型数据的连接地址没有设置.");return false}},buildSubNode:function(b){if(Ext.isEmpty(b)){return}for(var a=0;a<b.length;a++){var e;if(b[a].parentId==this.rootNode.id){e=this.rootNode}else{e=this.treePnl.getNodeById(""+b[a].parentId)}var d=this.treePnl.getNodeById(""+b[a].nodeId);if(typeof d=="undefined"&&typeof e!="undefined"){var c=this.buildNodeObj(b[a]);e.appendChild(c);c.ui.updateExpandIcon()}}},setVal:function(b,a){this.setValue(b);this.setRawValue(a);if(this.hiddenField){this.hiddenField.value=b}},buildNodeObj:function(a){return new Ext.tree.MyTreeNode({id:""+a.nodeId,text:a.nodeTxt,locationKindCd:a.locationKindCd,border:false,hadLoad:false,listeners:{scope:this,dblclick:this.nodeDblClick,click:this.nodeClick}})},getRootNode:function(){return new Ext.tree.TreeNode({text:"树根节点",id:"0",hadLoad:true})},nodeDblClick:function(a){this.setValue(a.attributes.text);this.setRawValue(a.attributes.text);if(this.hiddenField){this.hiddenField.value=a.id}this.otherSet(a);this.collapse()},getTreeUrl:function(){return null},otherSet:function(a){}});Ext.namespace("Ext.ux");Ext.override(Ext.grid.RowSelectionModel,{onEditorKey:function(f,k){var u=k.getKey(),t,s=this.grid,c=s.lastEdit,r=s.activeEditor,v=k.shiftKey,e,c,w,j,x=this.grid.store.getCount();if(u==k.TAB){k.stopEvent();r.completeEdit();if(v){if(r.row==0&&r.col==1){t=s.walkCells(r.row,r.col,-1,this.acceptsNav,this)}else{var g=this.getEdColIndex2(r.row,r.col-1);if(g==null){var y=r.row;if(r.row>0){y=r.row-1}g=this.getEdColIndex2(y,(s.colModel).getColumnCount()-1);if(g!=null){t=s.walkCells(y,g,-1,this.acceptsNav,this)}else{t=s.walkCells(y,r.col,-1,this.acceptsNav,this)}}else{t=s.walkCells(r.row,g,-1,this.acceptsNav,this)}}}else{if(c.col==(s.colModel).getColumnCount()-1){if(r.row<x-1){t=s.walkCells(r.row+1,1,1,this.acceptsNav,this)}else{t=s.walkCells(r.row,r.col,1,this.acceptsNav,this)}}else{var g=this.getEdColIndex(r.row,r.col+1);if(g!=null){t=s.walkCells(r.row,g,1,this.acceptsNav,this)}else{var g=null;if(r.row<x-1){g=this.getEdColIndex(r.row+1,1)}if(g!=null){t=s.walkCells(r.row+1,g,1,this.acceptsNav,this)}else{t=s.walkCells(r.row,r.col,1,this.acceptsNav,this)}}}}}else{if(u==k.ENTER){if(this.moveEditorOnEnter!==false){if(v){if(c.row==0&&c.col==1){t=s.walkCells(c.row,c.col,-1,this.acceptsNav,this)}else{var g=this.getEdColIndex2(c.row,c.col-1);if(g==null){var y=c.row;if(c.row>0){y=c.row-1}g=this.getEdColIndex2(y,(s.colModel).getColumnCount()-1);if(g!=null){t=s.walkCells(y,g,-1,this.acceptsNav,this)}else{t=s.walkCells(y,c.col,-1,this.acceptsNav,this)}}else{t=s.walkCells(c.row,g,-1,this.acceptsNav,this)}}}else{if(c.col==(s.colModel).getColumnCount()-1){if(c.row<x-1){var g=this.getEdColIndex(c.row+1,1);t=s.walkCells(c.row+1,g,1,this.acceptsNav,this)}else{t=s.walkCells(c.row,c.col,1,this.acceptsNav,this)}}else{var g=this.getEdColIndex(c.row,c.col+1);if(g!=null){t=s.walkCells(c.row,g,1,this.acceptsNav,this)}else{var g=null;if(c.row<x-1){g=this.getEdColIndex(c.row+1,1)}if(g!=null){t=s.walkCells(c.row+1,g,1,this.acceptsNav,this)}else{t=s.walkCells(c.row,c.col,1,this.acceptsNav,this)}}}}}}}if(t){w=t[0];j=t[1];this.onEditorSelect(w,c.row);s.startEditing(w,j)}},onKeyPress:function(k,e){var f=e=="up",j=f?"selectPrevious":"selectNext",m=f?-1:1,n;if(!k.shiftKey||this.singleSelect){this[j](false)}else{if(this.last!==false&&this.lastActive!==false){n=this.last;this.selectRange(this.last,this.lastActive+m);this.grid.getView().focusRow(this.lastActive);if(n!==false){this.last=n}}else{this.selectFirstRow()}}},selectNext:function(b){if(this.hasNext()){this.selectRow(this.last+1,b);this.grid.getView().focusRow(this.last);this.startEdt(this.last);return true}return false},selectPrevious:function(b){if(this.hasPrevious()){this.selectRow(this.last-1,b);this.grid.getView().focusRow(this.last);this.startEdt(this.last);return true}return false},startEdt:function(c){var a=this.grid.colModel;var d=a.getColumnCount();for(var b=0;b<d;b++){if(a.isCellEditable(b,c)){this.grid.startEditing(c,b);return true}}},getEdColIndex:function(j,m){var f=this.grid.store.getAt(j);var a=this.grid.colModel;var k=a.getColumnCount();for(var b=m;b<k;b++){var c=this.grid.colModel.getDataIndex(b),e={grid:this.grid,record:f,field:c,value:f.data[c],row:j,column:b,cancel:false};if(this.grid.fireEvent("beforeedit",e)!==false&&!e.cancel){if(a.isCellEditable(b,j)){return b}}}return null},getEdColIndex2:function(j,n){var f=this.grid.store.getAt(j);var b=this.grid.colModel;var m=b.getColumnCount();for(var a=n;a>=1;a--){var c=this.grid.colModel.getDataIndex(a),e={grid:this.grid,record:f,field:c,value:f.data[c],row:j,column:a,cancel:false};if(this.grid.fireEvent("beforeedit",e)!==false&&!e.cancel){if(b.isCellEditable(a,j)){return a}}}return null}});Ext.ux.MyBaseEdGrid=Ext.extend(Ext.grid.EditorGridPanel,{selType:1,addDisable:false,delDisable:false,delPkList:new Array(),vsingleSelect:true,gridType:0,vMethod:"POST",isShow:false,nowRec:null,otherBtns:[],autoAddFlg:false,btnFlg:1,initComponent:function(){if(!this.listeners){this.listeners={scope:this,beforeedit:function(h){this.nowRec=h.record}}}this.clicksToEdit=1;var a=this.getCol();var e=this.getColTitle();var b=[];if(this.selType==0){b=e}else{if(this.selType==1){var g=new Ext.grid.CheckboxSelectionModel({singleSelect:this.vsingleSelect,grid:this});b[0]=g;for(var f=0;f<e.length;f++){b[b.length]=e[f]}this.sm=g}}this.columns=b;var d=this.id;if(this.isShow){this.gridType=1}if(this.gridType==0){this.tbar=[];if(this.btnFlg==1){this.tbar[this.tbar.length]={xtype:"button",scope:this,iconCls:"add",text:"新 增",disabled:this.addDisable,handler:function(){var m=Ext.getCmp(d+"_rowNum").getValue();if(m>50){top.Ext.Msg.alert("提示信息","一次新增不能超过50行记录.");return false}var k=Ext.getCmp(d);var h=(k.store.getCount());for(var j=0;j<m;j++){k.insertRows()}if(k.store.getCount()>0){k.startEditorCol(h);k.getSelectionModel().selectRow(h)}}};this.tbar[this.tbar.length]={width:30,value:1,maxValue:50,xtype:"numberfield",id:d+"_rowNum",enableKeyEvents:true,listeners:{keyup:function(m,n){if(n.getKey()==n.ENTER){var o=Ext.getCmp(d+"_rowNum").getValue();if(o>50){top.Ext.Msg.alert("提示信息","一次新增不能超过50行记录.");return false}var k=Ext.getCmp(d);var h=(k.store.getCount());for(var j=0;j<o;j++){k.insertRows()}if(k.store.getCount()>0){k.startEditorCol(h);k.getSelectionModel().selectRow(h)}}}}};this.tbar[this.tbar.length]={xtype:"label",text:" 行"};this.tbar[this.tbar.length]="-"}if(this.btnFlg==1||this.btnFlg==2){this.tbar[this.tbar.length]={xtype:"button",iconCls:"delete",text:"删 除",disabled:this.delDisable,handler:function(){Ext.getCmp(d).deleteRows()}}}for(var c=0;c<this.otherBtns.length;c++){this.tbar[this.tbar.length]=this.otherBtns[c]}if(this.tbar.length==0){this.tbar=null}}this.store=new Ext.data.JsonStore({root:"data",idProperty:this.getPkField(),proxy:new Ext.data.HttpProxy({url:this.getQryUrl(),method:this.vMethod}),fields:a});Ext.ux.MyBaseEdGrid.superclass.initComponent.call(this)},startEditorCol:function(d){var c=(this.getSelectionModel()).grid;var a=c.colModel;var e=a.getColumnCount();for(var b=0;b<e;b++){if(a.isCellEditable(b,d)){c.startEditing(d,b);return true}}},editorFirstRow:function(){if(this.store.getCount()>=1){this.startEditorCol(0);this.getSelectionModel().selectRow(0)}},queryData:function(a){this.store.baseParams=a;this.store.load({scope:this,callback:function(c,b,d){if(d){}}})},insertRows:function(){var b=new this.store.recordType();b.data={};var c=this.store.fields.keys;for(var a=0;a<c.length;a++){b.data[c[a]]=""}this.store.insert(this.store.getCount(),b);if(this.isVisible()){this.stopEditing();(Ext.getCmp(this.id).getSelectionModel()).selectFirstRow();this.startEditing(0,0)}return b},delPkListClean:function(){this.delPkList.length=0;this.delPkList=[]},deleteRows:function(){var c=this;var d=c.getSelectionModel().getSelections();for(var a=0;a<d.length;a++){if(c.getPkField()!=null){var b=d[a].get(c.getPkField());if(b!=null&&b.length>0){c.delPkList[(c.delPkList).length]=b}}c.store.remove(d[a])}},g_edGridFieldValid:function(m){var o=this.getColumnModel();var a=this.store;var j=this.store.getCount();for(var e=0;e<j;e++){var g=a.getAt(e);var h=g.fields.keys;for(var c=0;c<h.length;c++){var p=o.findColumnIndex(h[c]);var n=g.data[h[c]];if(p==-1){continue}var b=a.indexOfId(g.id);var d=o.getCellEditor(p);if(d!=null&&typeof d!="undefined"&&d.field!=null&&typeof d.field!="undefined"){var f=d.field;if(!f.validateValue(n)){if(typeof this.title!="undefined"){g_showTip(m,this.title+"数据，必须输入的列字段不能为空.")}else{g_showTip(m,"表格数据，必须输入的列字段不能为空.")}if(this.isVisible()){this.startEditing(b,p)}return false}}}}return true},getOneSel:function(c){var b=this.getSelectionModel().getSelections();var a="";if(typeof c!="undefined"){a=c}if(b.length==0){top.Ext.Msg.alert("提示信息","请您至少选择一条"+a+"记录.");return null}else{if(b.length>1){top.Ext.Msg.alert("提示信息","只能选择一条"+a+"记录.");return null}else{return b[0]}}},getSel:function(){var a=this.getSelectionModel().getSelections();if(a.length==0){top.Ext.Msg.alert("提示信息","请您至少选择一条记录.");return null}else{return a}},insertRec:function(e){var d=this.store.fields.keys;for(var b=0;b<e.length;b++){var c=new this.store.recordType();c.data={};for(var a=0;a<d.length;a++){c.data[d[a]]=e[b].get(d[a])}this.store.insert(this.store.getCount(),c)}},countFldVal:function(a,g){var c=this.store;vCount=c.getCount();var e="";var b=0;if(vCount>0){for(var d=0;d<vCount;d++){var f=c.getAt(d);if(f.get(a)==g){b++}}}return b},getRecByFldVal:function(a,g){var c=this.store;vCount=c.getCount();var e="";var b=0;if(vCount>0){for(var d=0;d<vCount;d++){var f=c.getAt(d);if(f.get(a)==g){return f}}}return null},countFldVal:function(a,h,f){var c=this.store;vCount=c.getCount();var e="";var b=0;if(vCount>0){for(var d=0;d<vCount;d++){var g=c.getAt(d);if(g.get(a)==h&&f!=d){b++}}}return b},onDestroy:function(){if(this.body){var a=this.body;a.removeAllListeners();a.update("")}if(this.rendered){Ext.destroy(this.view,this.loadMask)}else{if(this.store){this.store.destroy()}}Ext.destroy(this.colModel,this.columns,this.bbar,this.store);delete this.selType;delete this.addDisable;delete this.delDisable;delete this.delPkList;delete this.vsingleSelect;delete this.gridType;delete this.store;delete this.colModel;delete this.view;delete this.loadMask;Ext.ux.MyBaseEdGrid.superclass.onDestroy.call(this)},getColTitle:function(){return[]},getCol:function(){return[]},getQryUrl:function(){return null},getPkField:function(){return null}});Ext.reg("myBaseEdGrid",Ext.ux.MyBaseEdGrid);if("function"!==typeof RegExp.escape){RegExp.escape=function(a){if("string"!==typeof a){return a}return a.replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\$1")}}Ext.ns("Ext.ux.form");Ext.ux.form.LovCombo=Ext.extend(Ext.ux.BaseComBox,{checkField:"checked",separator:",",initComponent:function(){if(!this.tpl){this.tpl='<tpl for="."><div class="x-combo-list-item"><img src="'+Ext.BLANK_IMAGE_URL+'" class="ux-lovcombo-icon ux-lovcombo-icon-{[values.'+this.checkField+'?"checked":"unchecked"]}"><div class="ux-lovcombo-item-text">{'+(this.displayField||"text")+"}</div></div></tpl>"}Ext.ux.form.LovCombo.superclass.initComponent.apply(this,arguments);this.on({scope:this,beforequery:this.onBeforeQuery,blur:this.onRealBlur});this.onLoad=this.onLoad.createSequence(function(){if(this.el){var a=this.el.dom.value;this.el.dom.value="";this.el.dom.value=a}})},initEvents:function(){Ext.ux.form.LovCombo.superclass.initEvents.apply(this,arguments);this.keyNav.tab=false},clearValue:function(){this.value="";this.setRawValue(this.value);this.store.clearFilter();this.store.each(function(a){a.set(this.checkField,false)},this);if(this.hiddenField){this.hiddenField.value=""}this.applyEmptyText()},getCheckedDisplay:function(){var a=new RegExp(this.separator,"g");return this.getCheckedValue(this.displayField).replace(a,this.separator+" ")},getCheckedValue:function(b){b=b||this.valueField;var d=[];var a=this.store.snapshot||this.store.data;a.each(function(c){if(c.get(this.checkField)){d.push(c.get(b))}},this);return d.join(this.separator)},onBeforeQuery:function(a){a.query=a.query.replace(new RegExp(this.getCheckedDisplay()+"[ "+this.separator+"]*"),"")},onRealBlur:function(){this.list.hide();var d=this.getRawValue();var a=d.split(new RegExp(RegExp.escape(this.separator)+" *"));var c=[];var b=this.store.snapshot||this.store.data;Ext.each(a,function(e){b.each(function(f){if(e===f.get(this.displayField)){c.push(f.get(this.valueField))}},this)},this);this.setValue(c.join(this.separator));this.store.clearFilter()},onSelect:function(a,b){if(this.fireEvent("beforeselect",this,a,b)!==false){a.set(this.checkField,!a.get(this.checkField));if(this.store.isFiltered()){this.doQuery(this.allQuery)}this.setValue(this.getCheckedValue());this.fireEvent("select",this,a,b)}},setValue:function(a){if(a){a=""+a;if(this.valueField){this.store.clearFilter();this.store.each(function(c){var b=!(!a.match("(^|"+this.separator+")"+RegExp.escape(c.get(this.valueField))+"("+this.separator+"|$)"));c.set(this.checkField,b)},this);this.value=this.getCheckedValue();this.setRawValue(this.getCheckedDisplay());if(this.hiddenField){this.hiddenField.value=this.value}}else{this.value=a;this.setRawValue(a);if(this.hiddenField){this.hiddenField.value=a}}if(this.el){this.el.removeClass(this.emptyClass)}}else{this.clearValue()}},selectAll:function(){this.store.each(function(a){a.set(this.checkField,true)},this);this.doQuery(this.allQuery);this.setValue(this.getCheckedValue())},deselectAll:function(){this.clearValue()}});Ext.reg("lovcombo",Ext.ux.form.LovCombo);Ext.grid.CheckColumn=function(a){Ext.apply(this,a);if(!this.id){this.id=Ext.id()}this.renderer=this.renderer.createDelegate(this)};Ext.grid.CheckColumn.prototype={init:function(a){this.grid=a;this.grid.on("render",function(){var b=this.grid.getView();b.mainBody.on("mousedown",this.onMouseDown,this)},this)},onMouseDown:function(h,c){if(c.id==this.id){h.stopEvent();var b=this.grid.getView().findRowIndex(c);var d=this.grid.getView().findCellIndex(c);var a=this.grid.store.getAt(b);var g=this.grid.colModel.getDataIndex(d);var f=!a.data[this.dataIndex];a.set(this.dataIndex,f);var h={grid:this.grid,record:a,field:g,originalValue:a.data[this.dataIndex],value:!a.data[this.dataIndex],row:b,column:d};this.grid.fireEvent("afteredit",h)}},renderer:function(b,c,a){c.css+=" x-grid3-check-col-td";return'<div id="'+this.id+'" class="x-grid3-check-col'+(b?"-on":"")+'">&#160;</div>'}};
/*!
 * Ext JS Library 3.1.1
 * Copyright(c) 2006-2010 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.ux.Spinner=Ext.extend(Ext.util.Observable,{incrementValue:1,alternateIncrementValue:5,triggerClass:"x-form-spinner-trigger",splitterClass:"x-form-spinner-splitter",alternateKey:Ext.EventObject.shiftKey,defaultValue:0,accelerate:false,constructor:function(a){Ext.ux.Spinner.superclass.constructor.call(this,a);Ext.apply(this,a);this.mimicing=false},init:function(a){this.field=a;a.afterMethod("onRender",this.doRender,this);a.afterMethod("onEnable",this.doEnable,this);a.afterMethod("onDisable",this.doDisable,this);a.afterMethod("afterRender",this.doAfterRender,this);a.afterMethod("onResize",this.doResize,this);a.afterMethod("onFocus",this.doFocus,this);a.beforeMethod("onDestroy",this.doDestroy,this)},doRender:function(b,a){var c=this.el=this.field.getEl();var d=this.field;if(!d.wrap){d.wrap=this.wrap=c.wrap({cls:"x-form-field-wrap"})}else{this.wrap=d.wrap.addClass("x-form-field-wrap")}this.trigger=this.wrap.createChild({tag:"img",src:Ext.BLANK_IMAGE_URL,cls:"x-form-trigger "+this.triggerClass});if(!d.width){this.wrap.setWidth(c.getWidth()+this.trigger.getWidth())}this.splitter=this.wrap.createChild({tag:"div",cls:this.splitterClass,style:"width:13px; height:2px;"});this.splitter.setRight((Ext.isIE)?1:2).setTop(10).show();this.proxy=this.trigger.createProxy("",this.splitter,true);this.proxy.addClass("x-form-spinner-proxy");this.proxy.setStyle("left","0px");this.proxy.setSize(14,1);this.proxy.hide();this.dd=new Ext.dd.DDProxy(this.splitter.dom.id,"SpinnerDrag",{dragElId:this.proxy.id});this.initTrigger();this.initSpinner()},doAfterRender:function(){var a;if(Ext.isIE&&this.el.getY()!=(a=this.trigger.getY())){this.el.position();this.el.setY(a)}},doEnable:function(){if(this.wrap){this.wrap.removeClass(this.field.disabledClass)}},doDisable:function(){if(this.wrap){this.wrap.addClass(this.field.disabledClass);this.el.removeClass(this.field.disabledClass)}},doResize:function(a,b){if(typeof a=="number"){this.el.setWidth(a-this.trigger.getWidth())}this.wrap.setWidth(this.el.getWidth()+this.trigger.getWidth())},doFocus:function(){if(!this.mimicing){this.wrap.addClass("x-trigger-wrap-focus");this.mimicing=true;Ext.get(Ext.isIE?document.body:document).on("mousedown",this.mimicBlur,this,{delay:10});this.el.on("keydown",this.checkTab,this)}},checkTab:function(a){if(a.getKey()==a.TAB){this.triggerBlur()}},mimicBlur:function(a){if(!this.wrap.contains(a.target)&&this.field.validateBlur(a)){this.triggerBlur()}},triggerBlur:function(){this.mimicing=false;Ext.get(Ext.isIE?document.body:document).un("mousedown",this.mimicBlur,this);this.el.un("keydown",this.checkTab,this);this.field.beforeBlur();this.wrap.removeClass("x-trigger-wrap-focus");this.field.onBlur.call(this.field)},initTrigger:function(){this.trigger.addClassOnOver("x-form-trigger-over");this.trigger.addClassOnClick("x-form-trigger-click")},initSpinner:function(){this.field.addEvents({spin:true,spinup:true,spindown:true});this.keyNav=new Ext.KeyNav(this.el,{up:function(a){a.preventDefault();this.onSpinUp()},down:function(a){a.preventDefault();this.onSpinDown()},pageUp:function(a){a.preventDefault();this.onSpinUpAlternate()},pageDown:function(a){a.preventDefault();this.onSpinDownAlternate()},scope:this});this.repeater=new Ext.util.ClickRepeater(this.trigger,{accelerate:this.accelerate});this.field.mon(this.repeater,"click",this.onTriggerClick,this,{preventDefault:true});this.field.mon(this.trigger,{mouseover:this.onMouseOver,mouseout:this.onMouseOut,mousemove:this.onMouseMove,mousedown:this.onMouseDown,mouseup:this.onMouseUp,scope:this,preventDefault:true});this.field.mon(this.wrap,"mousewheel",this.handleMouseWheel,this);this.dd.setXConstraint(0,0,10);this.dd.setYConstraint(1500,1500,10);this.dd.endDrag=this.endDrag.createDelegate(this);this.dd.startDrag=this.startDrag.createDelegate(this);this.dd.onDrag=this.onDrag.createDelegate(this)},onMouseOver:function(){if(this.disabled){return}var a=this.getMiddle();this.tmpHoverClass=(Ext.EventObject.getPageY()<a)?"x-form-spinner-overup":"x-form-spinner-overdown";this.trigger.addClass(this.tmpHoverClass)},onMouseOut:function(){this.trigger.removeClass(this.tmpHoverClass)},onMouseMove:function(){if(this.disabled){return}var a=this.getMiddle();if(((Ext.EventObject.getPageY()>a)&&this.tmpHoverClass=="x-form-spinner-overup")||((Ext.EventObject.getPageY()<a)&&this.tmpHoverClass=="x-form-spinner-overdown")){}},onMouseDown:function(){if(this.disabled){return}var a=this.getMiddle();this.tmpClickClass=(Ext.EventObject.getPageY()<a)?"x-form-spinner-clickup":"x-form-spinner-clickdown";this.trigger.addClass(this.tmpClickClass)},onMouseUp:function(){this.trigger.removeClass(this.tmpClickClass)},onTriggerClick:function(){if(this.disabled||this.el.dom.readOnly){return}var b=this.getMiddle();var a=(Ext.EventObject.getPageY()<b)?"Up":"Down";this["onSpin"+a]()},getMiddle:function(){var b=this.trigger.getTop();var c=this.trigger.getHeight();var a=b+(c/2);return a},isSpinnable:function(){if(this.disabled||this.el.dom.readOnly){Ext.EventObject.preventDefault();return false}return true},handleMouseWheel:function(a){if(this.wrap.hasClass("x-trigger-wrap-focus")==false){return}var b=a.getWheelDelta();if(b>0){this.onSpinUp();a.stopEvent()}else{if(b<0){this.onSpinDown();a.stopEvent()}}},startDrag:function(){this.proxy.show();this._previousY=Ext.fly(this.dd.getDragEl()).getTop()},endDrag:function(){this.proxy.hide()},onDrag:function(){if(this.disabled){return}var b=Ext.fly(this.dd.getDragEl()).getTop();var a="";if(this._previousY>b){a="Up"}if(this._previousY<b){a="Down"}if(a!=""){this["onSpin"+a]()}this._previousY=b},onSpinUp:function(){if(this.isSpinnable()==false){return}if(Ext.EventObject.shiftKey==true){this.onSpinUpAlternate();return}else{this.spin(false,false)}this.field.fireEvent("spin",this);this.field.fireEvent("spinup",this)},onSpinDown:function(){if(this.isSpinnable()==false){return}if(Ext.EventObject.shiftKey==true){this.onSpinDownAlternate();return}else{this.spin(true,false)}this.field.fireEvent("spin",this);this.field.fireEvent("spindown",this)},onSpinUpAlternate:function(){if(this.isSpinnable()==false){return}this.spin(false,true);this.field.fireEvent("spin",this);this.field.fireEvent("spinup",this)},onSpinDownAlternate:function(){if(this.isSpinnable()==false){return}this.spin(true,true);this.field.fireEvent("spin",this);this.field.fireEvent("spindown",this)},spin:function(d,b){var a=parseFloat(this.field.getValue());var c=(b==true)?this.alternateIncrementValue:this.incrementValue;(d==true)?a-=c:a+=c;a=(isNaN(a))?this.defaultValue:a;a=this.fixBoundries(a);this.field.setRawValue(a)},fixBoundries:function(b){var a=b;if(this.field.minValue!=undefined&&a<this.field.minValue){a=this.field.minValue}if(this.field.maxValue!=undefined&&a>this.field.maxValue){a=this.field.maxValue}return this.fixPrecision(a)},fixPrecision:function(b){var a=isNaN(b);if(!this.field.allowDecimals||this.field.decimalPrecision==-1||a||!b){return a?"":b}return parseFloat(parseFloat(b).toFixed(this.field.decimalPrecision))},doDestroy:function(){if(this.trigger){this.trigger.remove()}if(this.wrap){this.wrap.remove();delete this.field.wrap}if(this.splitter){this.splitter.remove()}if(this.dd){this.dd.unreg();this.dd=null}if(this.proxy){this.proxy.remove()}if(this.repeater){this.repeater.purgeListeners()}}});Ext.form.Spinner=Ext.ux.Spinner;
/*!
 * Ext JS Library 3.1.1
 * Copyright(c) 2006-2010 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.ns("Ext.ux.form");Ext.ux.form.SpinnerField=Ext.extend(Ext.form.NumberField,{actionMode:"wrap",deferHeight:true,autoSize:Ext.emptyFn,onBlur:Ext.emptyFn,adjustSize:Ext.BoxComponent.prototype.adjustSize,constructor:function(c){var b=Ext.copyTo({},c,"incrementValue,alternateIncrementValue,accelerate,defaultValue,triggerClass,splitterClass");var d=this.spinner=new Ext.ux.Spinner(b);var a=c.plugins?(Ext.isArray(c.plugins)?c.plugins.push(d):[c.plugins,d]):d;Ext.ux.form.SpinnerField.superclass.constructor.call(this,Ext.apply(c,{plugins:a}))},getResizeEl:function(){return this.wrap},getPositionEl:function(){return this.wrap},alignErrorIcon:function(){if(this.wrap){this.errorIcon.alignTo(this.wrap,"tl-tr",[2,0])}},validateBlur:function(){return true}});Ext.reg("spinnerfield",Ext.ux.form.SpinnerField);Ext.form.SpinnerField=Ext.ux.form.SpinnerField;Ext.ns("Ext.ux.form");Ext.ux.form.TimePickerField=function(a){Ext.ux.form.TimePickerField.superclass.constructor.call(this,a)};Ext.extend(Ext.ux.form.TimePickerField,Ext.form.Field,{defaultAutoCreate:{tag:"div"},cls:"x-form-timepickerfield",hoursSpinner:null,minutesSpinner:null,secondsSpinner:null,spinnerCfg:{width:40},spinnerFixBoundries:function(a){if(a<=this.field.minValue){a=this.field.maxValue}if(a>=this.field.maxValue){a=this.field.minValue}return this.fixPrecision(a)},onRender:function(d,a){Ext.ux.form.TimePickerField.superclass.onRender.call(this,d,a);this.rendered=false;this.date=new Date();var c={};if(this.value){c=this._valueSplit(this.value);this.date.setHours(c.h);this.date.setMinutes(c.m);this.date.setSeconds(c.s);delete this.value}else{c={h:this.date.getHours(),m:this.date.getMinutes(),s:this.date.getSeconds()}}var e=Ext.DomHelper.append(this.el,{tag:"div"});var b=Ext.apply({},this.spinnerCfg,{renderTo:e,readOnly:this.readOnly,disabled:this.disabled,listeners:{spin:{fn:this.onSpinnerChange,scope:this},valid:{fn:this.onSpinnerChange,scope:this},afterrender:{fn:function(f){f.wrap.applyStyles("float: left")},single:true}}});this.hoursSpinner=new Ext.ux.form.SpinnerField(Ext.apply({},b,{minValue:0,maxValue:23,cls:"first",value:c.h}));this.minutesSpinner=new Ext.ux.form.SpinnerField(Ext.apply({},b,{minValue:0,maxValue:59,value:c.m}));this.secondsSpinner=new Ext.ux.form.SpinnerField(Ext.apply({},b,{minValue:0,maxValue:59,value:c.s}));Ext.DomHelper.append(e,{tag:"div",cls:"x-form-clear-left"});this.rendered=true},_valueSplit:function(a){var b=a.split(":");return{h:b.length>0?b[0]:0,m:b.length>1?b[1]:0,s:b.length>2?b[2]:0}},onSpinnerChange:function(){if(!this.rendered){return}this.fireEvent("change",this,this.getRawValue())},disable:function(){Ext.ux.form.TimePickerField.superclass.disable.call(this);this.hoursSpinner.disable();this.minutesSpinner.disable();this.secondsSpinner.disable()},enable:function(){Ext.ux.form.TimePickerField.superclass.enable.call(this);this.hoursSpinner.enable();this.minutesSpinner.enable();this.secondsSpinner.enable()},setReadOnly:function(a){Ext.ux.form.TimePickerField.superclass.setReadOnly.call(this,a);this.hoursSpinner.setReadOnly(a);this.minutesSpinner.setReadOnly(a);this.secondsSpinner.setReadOnly(a)},clearInvalid:function(){Ext.ux.form.TimePickerField.superclass.clearInvalid.call(this);this.hoursSpinner.clearInvalid();this.minutesSpinner.clearInvalid();this.secondsSpinner.clearInvalid()},getRawValue:function(){if(!this.hoursSpinner){this.date=new Date();return{h:this.date.getHours(),m:this.date.getMinutes(),s:this.date.getSeconds()}}else{return{h:this.hoursSpinner.getValue(),m:this.minutesSpinner.getValue(),s:this.secondsSpinner.getValue()}}},setRawValue:function(a){this.hoursSpinner.setValue(a.h);this.minutesSpinner.setValue(a.m);this.secondsSpinner.setValue(a.s)},isValid:function(a){return this.hoursSpinner.isValid(a)&&this.minutesSpinner.isValid(a)&&this.secondsSpinner.isValid(a)},validate:function(){return this.hoursSpinner.validate()&&this.minutesSpinner.validate()&&this.secondsSpinner.validate()},getValue:function(){var a=this.getRawValue();return String.leftPad(a.h,2,"0")+":"+String.leftPad(a.m,2,"0")+":"+String.leftPad(a.s,2,"0")},setValue:function(a){if(!this.rendered){this.value=a;return}a=this._valueSplit(a);this.setRawValue(a);this.validate()}});Ext.form.TimePickerField=Ext.ux.form.TimePickerField;Ext.reg("timepickerfield",Ext.form.TimePickerField);Ext.ns("Ext.ux.form");Ext.DateTimePicker=Ext.extend(Ext.DatePicker,{timeFormat:"g:i:s A",timeLabel:"时间",timeWidth:100,initComponent:function(){Ext.DateTimePicker.superclass.initComponent.call(this);this.id=Ext.id()},onRender:function(b,a){Ext.DateTimePicker.superclass.onRender.apply(this,arguments);var d=Ext.get(Ext.DomQuery.selectNode("table tbody",b.dom));var f=Ext.DomHelper.insertBefore(d.last(),{tag:"tr",children:[{tag:"td",cls:"x-date-bottom",html:this.timeLabel,style:"width:30;"},{tag:"td",cls:"x-date-bottom ux-timefield",colspan:"2"}]},true);this.tf.render(d.child("td.ux-timefield"));var c=this.value;if(c!=null){this.tf.setRawValue({h:c.getHours(),m:c.getMinutes(),s:c.getSeconds()})}var e=this.getEl().parent("div.x-layer");if(e){if(!Ext.isIE8&&!Ext.isOpera){e.setStyle("height",e.getHeight()+32)}}},setValue:function(b){var a=this.value;if(!this.tf){this.tf=new Ext.ux.form.TimePickerField();this.tf.ownerCt=this}this.value=this.getDateTime(b)},getDateTime:function(c){if(this.tf){var b=new Date();var a=this.tf.getValue();c=Date.parseDate(c.format("Y-m-d")+" "+this.tf.getValue(),"Y-m-d H:i:s")}return c},selectToday:function(){if(this.todayBtn&&!this.todayBtn.disabled){this.value=this.getDateTime(new Date());this.fireEvent("select",this,this.value)}}});Ext.reg("datetimepickerfield",Ext.DateTimePicker);if(parseInt(Ext.version.substr(0,1),10)>2){Ext.menu.DateTimeItem=Ext.DateTimePicker;Ext.override(Ext.menu.DateMenu,{initComponent:function(){this.on("beforeshow",this.onBeforeShow,this);if(this.strict=(Ext.isIE7&&Ext.isStrict)){this.on("show",this.onShow,this,{single:true,delay:20})}Ext.apply(this,{plain:true,showSeparator:false,items:this.picker=new Ext.DatePicker(Ext.apply({internalRender:this.strict||!Ext.isIE,ctCls:"x-menu-date-item"},this.initialConfig))});Ext.menu.DateMenu.superclass.initComponent.call(this);this.relayEvents(this.picker,["select"]);this.on("select",this.menuHide,this);if(this.handler){this.on("select",this.handler,this.scope||this)}}})}else{Ext.menu.DateTimeItem=function(a){Ext.menu.DateTimeItem.superclass.constructor.call(this,new Ext.DateTimePicker(a),a);this.picker=this.component;this.addEvents("select");this.picker.on("render",function(b){b.getEl().swallowEvent("click");b.container.addClass("x-menu-date-item")});this.picker.on("select",this.onSelect,this)};Ext.extend(Ext.menu.DateTimeItem,Ext.menu.DateMenu,{onSelect:function(b,a){this.fireEvent("select",this,a,b);Ext.menu.DateTimeItem.superclass.handleClick.call(this)}})}Ext.menu.DateTimeMenu=function(a){Ext.menu.DateTimeMenu.superclass.constructor.call(this,a);this.plain=true;var b=new Ext.menu.DateTimeItem(a);this.add(b);this.picker=b;this.relayEvents(b,["select"]);this.on("beforeshow",function(){if(this.picker){this.picker.hideMonthPicker(true)}},this)};Ext.extend(Ext.menu.DateTimeMenu,Ext.menu.Menu,{cls:"x-date-menu",beforeDestroy:function(){this.picker.destroy()},hide:function(a){if(this.picker.tf.innerList){if((Ext.EventObject.within(this.picker.tf.innerList))||(Ext.get(Ext.EventObject.getTarget())==this.picker.tf.innerList)){return false}}if(this.el&&this.isVisible()){this.fireEvent("beforehide",this);if(this.activeItem){this.activeItem.deactivate();this.activeItem=null}this.el.hide();this.hidden=true;this.fireEvent("hide",this)}if(a===true&&this.parentMenu){this.parentMenu.hide(true)}}});Ext.ux.form.DateTimeField=Ext.extend(Ext.form.DateField,{format:"Y-m-d H:i:s",dateFormat:"Y-m-d",timeFormat:"H:i:s",initTime:"00",defaultAutoCreate:{tag:"input",type:"text",size:"20",autocomplete:"off"},safeParse:function(d,f){if(/[gGhH]/.test(f.replace(/(\\.)/g,""))){return Date.parseDate(d,f)}else{var e=Date.parseDate(d+" "+this.initTime,f+" "+this.initTimeFormat);if(e){return e}}},getErrors:function(n){var k=Ext.form.DateField.superclass.getErrors.apply(this,arguments);n=this.formatDate(n||this.processValue(this.getRawValue()));if(n.length<1){return k}var p=n;n=this.parseDate(n);if(!n){k.push(String.format(this.invalidText,p,this.format));return k}var m=n.clearTime().getTime();if(this.minValue&&m<this.minValue.clearTime().getTime()){k.push(String.format(this.minText,this.strMinValue))}if(this.maxValue&&m>this.maxValue.clearTime().getTime()){k.push(String.format(this.maxText,this.strMaxValue))}if(this.disabledDays){var j=n.getDay();for(var f=0;f<this.disabledDays.length;f++){if(j===this.disabledDays[f]){k.push(this.disabledDaysText);break}}}var o=this.formatDate(n);if(this.disabledDatesRE&&this.disabledDatesRE.test(o)){k.push(String.format(this.disabledDatesText,o))}return k},initComponent:function(){this.strMaxValue=this.maxValue;this.strMinValue=this.minValue;Ext.ux.form.DateTimeField.superclass.initComponent.call(this);this.format=this.format;this.afterMethod("afterRender",function(){this.getEl().applyStyles("top:0")})},getValue:function(){return Date.parseDate(Ext.form.DateField.superclass.getValue.call(this),this.format)||""},onTriggerClick:function(){if(this.disabled){return}if(this.menu==null){this.menu=new Ext.menu.DateTimeMenu()}var a=this.formatDate(this.getRawValue());this.setValue(a);Ext.apply(this.menu.picker,{minDate:this.minValue,maxDate:this.maxValue,value:this.value,disabledDatesRE:this.ddMatch,disabledDatesText:this.disabledDatesText,disabledDays:this.disabledDays,disabledDaysText:this.disabledDaysText,format:this.format,timeFormat:this.timeFormat,dateFormat:this.dateFormat,showToday:this.showToday,minText:String.format(this.minText,this.strMinValue),maxText:String.format(this.maxText,this.strMaxValue)});if(this.menuEvents){this.menuEvents("on")}else{this.menu.on(Ext.apply({},this.menuListeners,{scope:this}))}var b=this.getValue()||new Date();this.menu.picker.setValue(b);this.menu.show(this.el,"tl-bl?");this.menu.picker.tf.setRawValue({h:b.getHours(),m:b.getMinutes(),s:b.getSeconds()})}});Ext.reg("datetimefield",Ext.ux.form.DateTimeField);var provinceNames=["福建省","北京市","上海市","江苏省","浙江省","安微省","江西省","山东省","河南省","湖北省","湖南省","广东省","广西省","海南省","重庆市","云南省","天津市","河北省","山西省","内蒙古","辽宁省","吉林省","黑龙江省","四川省","贵州省","西藏","陕西省","甘肃省","青海省","宁夏","新疆"];var povinceCode=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31];var provinceDATA=[{value:"1",text:"福建省"},{value:"2",text:"北京市"},{value:"3",text:"上海市"},{value:"4",text:"江苏省"},{value:"5",text:"浙江省"},{value:"6",text:"安微省"},{value:"7",text:"江西省"},{value:"8",text:"山东省"},{value:"9",text:"河南省"},{value:"10",text:"湖北省"},{value:"11",text:"湖南省"},{value:"12",text:"广东省"},{value:"13",text:"广西省"},{value:"14",text:"海南省"},{value:"15",text:"重庆市"},{value:"16",text:"云南省"},{value:"17",text:"天津市"},{value:"18",text:"河北省"},{value:"19",text:"山西省"},{value:"20",text:"内蒙古"},{value:"21",text:"辽宁省"},{value:"22",text:"吉林省"},{value:"23",text:"黑龙江省"},{value:"24",text:"四川省"},{value:"25",text:"贵州省"},{value:"26",text:"西藏"},{value:"27",text:"陕西省"},{value:"28",text:"甘肃省"},{value:"29",text:"青海省"},{value:"30",text:"宁夏"},{value:"31",text:"新疆"}];var fjCityName=["福州","厦门","泉州","漳州","三明","莆田","南平","龙岩","宁德"];var fjCityCode=["0591","0592","0595","0596","0598","0594","0599","0597","0593"];var beiJingCityName=["北京"];var beiJingCityCode=["010"];var shangHaiCityName=["上海"];var shangHaiCityCode=["021"];var jsCityName=["南京","无锡","徐州","常州","苏州","南通","连云港","淮安","盐城","扬州","镇江","泰州","宿迁"];var jsCityCode=["025","0510","0516","0519","0512","0513","0518","0517","0515","0514","0511","0523","0527"];var zjCityName=["杭州","宁波","温州","嘉兴","湖州","绍兴","金华","衢州","舟山","台州","丽水"];var zjCityCode=["0571","0574","0577","0573","0572","0575","0579","0570","0580","0576","0578"];var awCityName=["合肥","芜湖","蚌埠","淮南","马鞍山","淮北","铜陵","安庆","黄山","滁州","阜阳","宿州","巢湖","六安","毫州","池州","宣城"];var awCityCode=["0551","0553","0552","0554","0555","0561","0562","0556","0559","0550","0558","0557","0565","0564","0558","0566","0563"];var jxCityName=["南昌","吉安","抚州","九江","景德镇","上饶","鹰潭","宜春","萍乡","赣州","抚州","新余"];var jxCityCode=["0791","0796","0794","0792","0798","0793","0701","0795","0799","0797","0794","0790"];var sdCtiyName=["济南","淄博","东营","烟台","青岛","莱芜","济宁","荷泽","日照","聊城","德州","滨州","潍坊","威海","泰安","临沂","枣庄"];var sdCtiyCode=["0531","0533","0546","0535","0532","0634","0537","0530","0633","0635","0534","0543","0536","0631","0538","0539","0632"];var heNanCityName=["郑州","焦作","鹤壁","许昌","驻马店","周口","洛阳","开封","新乡","安阳","濮阳","缧河","信阳","平顶山","三门峡","南阳","商丘"];var heNanCityCode=["0371","0391","0392","0374","0396","0394","0379","0378","0373","0372","0393","0395","0376","0375","0398","0377","0370"];var huBeiCtiyName=["武汉","天门","仙桃","荆门","咸宁","十堰","枝城","黄石","宜昌","襄樊","孝感","荆州","黄冈","随州","恩施","潜江","神农架"];var huBeiCityCode=["027","07280","07281","0724","0715","07190","07170","0714","07171","0710","0712","0716","0713","0722","0718","07282","07191"];var huNanCityName=["长沙","株洲","湘潭","衡阳","邵阳","岳阳","常德","张家界","益阳","郴州","永州","怀化","娄底","湘西"];var huNanCityCode=["0731","0733","0732","0734","0739","0730","0736","0744","7037","0735","0746","0745","0738","0743"];var gdCityName=["广州","韶关","梅州","潮州","汕尾","深圳","茂名","佛山","江门","清远","韶关","汕头","惠州","河源","湛江","肇庆","中山","阳江"];var gdCityCode=["020","0769","0753","0768","0660","0755","0668","0757","0750","0763","0751","0754","0752","0762","0759","0758","0760","0662"];var gxCityName=["南宁","百色","北海","桂林","柳州","河池","凭祥","钦州","玉林","梧州","合山","钦州","防城港"];var gxCityCode=["07710","0776","0779","0773","0772","0778","07711","077700","0775","0774","0772","07771","07701"];var haiNanCityName=["海口","三亚"];var haiNanCityCode=["08980","08981"];var chongQinCityName=["重庆"];var chongQinCityCode=["023"];var yunNanCityName=["昆明","曲靖","大理","保山","文山","临沧","昭通","楚雄","玉溪","丽江"];var yunNanCityCode=["0871","0874","0872","0875","0876","0883","0870","0878","0877","0888"];var tjCityName=["天津"];var tjCityCode=["022"];var heBeibCityName=["石家庄","张家口","承德","秦皇岛","唐山","廊坊","保定","沧州","衡水","邢台","邯郸"];var heBeiCityCode=["0311","0313","0314","0335","0315","0316","0312","0317","0318","0319","0310"];var sxCityName=["太原","大同","朔州","阳泉","长治","晋城","忻州","晋中","临汾","运城","吕梁"];var sxCityCode=["0351","0352","0349","0353","0355","0356","0350","0354","0357","0359","0358"];var nmgCityName=["呼和浩特","包头","乌海","赤峰","通辽","呼伦贝尔","兴安盟","鄂尔多斯","锡林郭勒","阿拉善","巴彦淖尔","乌兰察布","海拉尔","满洲里","乌兰浩特","锡林浩特"];var nmgCityCode=["0471","0472","0473","0476","0475","04700","0482","0477","0479","0483","0478","0474","04701","04702","0482","0479"];var lnCityName=["沈阳","朝阳","阜新","铁岭","抚顺","本溪","辽阳","鞍山","丹东","大连","营口","盘锦","锦州","葫芦岛"];var lnCityCode=["024","0421","0418","0410","0413","0414","0419","0412","0415","0411","0417","0427","0416","0429"];var jlCityName=["长春","延边","白城","松原","吉林","四平","辽源","通化","白山"];var jlCityCode=["0431","0431","0436","0438","0432","0434","0437","0435","0439"];var hljCityName=["哈尔滨","齐齐哈尔","黑河","大庆","鹤岗","佳木斯","牡丹江","大兴安岭","伊春","双鸭山","鸡西","七台河","绥化"];var hljCityCode=["0451","0452","0456","0459","04540","04541","04542","04530","0457","0458","04544","04531","04531","0455"];var scCityName=["成都","广元","绵阳","德阳","南充","广安","遂宁","内江","乐山","自贡","泸州","宜宾","攀枝花","巴中","达州","资阳","眉山","雅安","甘孜","凉山","阿坝","北海"];var scCityCode=["0280","0839","0816","0838","0817","0826","0825","0832","0833","0813","0830","0831","0812","0827","0818","0281","0282","0835","0836","0834","0837","0779"];var gzCityName=["贵阳","六盘水","遵义","安顺","毕节","黔东南","黔南","黔西南","铜仁"];var gzCityCode=["0851","0858","0852","0853","0857","0855","0854","0859","0856"];var xzCityName=["拉萨","阿里","昌都","林芝","日喀则","山南","那曲"];var xzCityCode=["0891","0897","0895","0894","0892","0983","0896"];var sxiCityName=["西安","咸阳","渭南","延安","宝鸡","汉中","铜川","榆林","商洛","安康"];var sxiCityCode=["029","0910","0913","0911","0917","0916","0919","0912","0914","0915"];var gsCityName=["兰州","酒泉","嘉峪关","张掖","天水","白银","定西","甘南","金昌","临夏","陇南","平凉","庆阳","武威"];var gsCityCode=["0931","09370","09371","0936","0938","0943","0932","0941","09350","09351","0930","0939","0933","0934","0935"];var qhCityName=["西宁","果洛","海北","海东","海南州","海西","黄南","树"];var qhCityCode=["0971","0975","0970","0972","0974","0979","0973","0976"];var nxCityName=["银川","石嘴山","固原","中卫","吴忠"];var nxCityCode=["0951","0952","0954","0955","0953"];var xjCityName=["乌鲁木齐","昌吉","克拉玛依","吐鲁番","哈密","石河子","伊犁","巴音郭楞","和田","阿勒泰","塔城","阿克苏 ","博尔塔拉","克孜勒苏","喀什","图木舒克","阿拉尔 ","五家渠"];var xjCityCode=["0991","09940","0990","0995","0902","0993","0999","0996","0903","0906","0901","0997","0909","0908","09980","09981","0997","09941"];function setCity(a,b){b.options.length=0;switch(a){case"1":initCityNameAndCode(a,b,fjCityName,fjCityCode);break;case"2":initCityNameAndCode(a,b,beiJingCityName,beiJingCityCode);break;case"3":initCityNameAndCode(a,b,shangHaiCityName,shangHaiCityCode);break;case"4":initCityNameAndCode(a,b,jsCityName,jsCityCode);break;case"5":initCityNameAndCode(a,b,zjCityName,zjCityCode);break;case"6":initCityNameAndCode(a,b,awCityName,awCityCode);break;case"7":initCityNameAndCode(a,b,jxCityName,jxCityCode);break;case"8":initCityNameAndCode(a,b,sdCtiyName,sdCtiyCode);break;case"9":initCityNameAndCode(a,b,heNanCityName,heNanCityCode);break;case"10":initCityNameAndCode(a,b,huBeiCtiyName,huBeiCityCode);break;case"11":initCityNameAndCode(a,b,huNanCityName,huNanCityCode);break;case"12":initCityNameAndCode(a,b,gdCityName,gdCityCode);break;case"13":initCityNameAndCode(a,b,gxCityName,gxCityCode);break;case"14":initCityNameAndCode(a,b,haiNanCityName,haiNanCityCode);break;case"15":initCityNameAndCode(a,b,chongQinCityName,chongQinCityCode);break;case"16":initCityNameAndCode(a,b,yunNanCityName,yunNanCityCode);break;case"17":initCityNameAndCode(a,b,tjCityName,tjCityCode);break;case"18":initCityNameAndCode(a,b,heBeibCityName,heBeibCityCode);break;case"19":initCityNameAndCode(a,b,sxCityName,sxCityCode);break;case"20":initCityNameAndCode(a,b,nmgCityName,nmgCityCode);break;case"21":initCityNameAndCode(a,b,lnCityName,lnCityCode);break;case"22":initCityNameAndCode(a,b,jlCityName,jlCityCode);break;case"23":initCityNameAndCode(a,b,hljCityName,hljCityCode);break;case"24":initCityNameAndCode(a,b,scCityName,scCityCode);break;case"25":initCityNameAndCode(a,b,gzCityName,gzCityCode);break;case"26":initCityNameAndCode(a,b,xzCityName,xzCityCode);break;case"27":initCityNameAndCode(a,b,sxiCityName,sxiCityCode);break;case"28":initCityNameAndCode(a,b,gsCityName,gsCityCode);break;case"29":initCityNameAndCode(a,b,qhCityName,qhCityCode);break;case"30":initCityNameAndCode(a,b,nxCityName,nxCityCode);break;case"31":initCityNameAndCode(a,b,xjCityName,xjCityCode);break}}function setCityW(a,c,b){c.options.length=0;c.options.add(new Option("选择城市","0"));switch(a){case"1":initCityNameAndCodeW(a,c,fjCityName,fjCityCode,b);break;case"2":initCityNameAndCodeW(a,c,beiJingCityName,beiJingCityCode,b);break;case"3":initCityNameAndCodeW(a,c,shangHaiCityName,shangHaiCityCode,b);break;case"4":initCityNameAndCodeW(a,c,jsCityName,jsCityCode,b);break;case"5":initCityNameAndCodeW(a,c,zjCityName,zjCityCode,b);break;case"6":initCityNameAndCodeW(a,c,awCityName,awCityCode,b);break;case"7":initCityNameAndCodeW(a,c,jxCityName,jxCityCode,b);break;case"8":initCityNameAndCodeW(a,c,sdCtiyName,sdCtiyCode,b);break;case"9":initCityNameAndCodeW(a,c,heNanCityName,heNanCityCode,b);break;case"10":initCityNameAndCodeW(a,c,huBeiCtiyName,huBeiCtiyCode,b);break;case"11":initCityNameAndCodeW(a,c,huNanCityName,huNanCityCode,b);break;case"12":initCityNameAndCodeW(a,c,gdCityName,gdCityCode,b);break;case"13":initCityNameAndCodeW(a,c,gxCityName,gxCityCode,b);break;case"14":initCityNameAndCodeW(a,c,haiNanCityName,haiNanCityCode,b);break;case"15":initCityNameAndCodeW(a,c,chongQinCityName,chongQinCityCode,b);break;case"16":initCityNameAndCodeW(a,c,yunNanCityName,yunNanCityCode,b);break;case"17":initCityNameAndCodeW(a,c,tjCityName,tjCityCode,b);break;case"18":initCityNameAndCodeW(a,c,heBeibCityName,heBeibCityCode,b);break;case"19":initCityNameAndCodeW(a,c,sxCityName,sxCityCode,b);break;case"20":initCityNameAndCodeW(a,c,nmgCityName,nmgCityCode,b);break;case"21":initCityNameAndCodeW(a,c,lnCityName,lnCityCode,b);break;case"22":initCityNameAndCodeW(a,c,jlCityName,jlCityCode,b);break;case"23":initCityNameAndCodeW(a,c,hljCityName,hljCityCode,b);break;case"24":initCityNameAndCodeW(a,c,scCityName,scCityCode,b);break;case"25":initCityNameAndCodeW(a,c,gzCityName,gzCityCode,b);break;case"26":initCityNameAndCodeW(a,c,xzCityName,xzCityCode,b);break;case"27":initCityNameAndCodeW(a,c,sxiCityName,sxiCityCode,b);break;case"28":initCityNameAndCodeW(a,c,gsCityName,gsCityCode),b;break;case"29":initCityNameAndCodeW(a,c,qhCityName,qhCityCode,b);break;case"30":initCityNameAndCodeW(a,c,nxCityName,nxCityCode,b);break;case"31":initCityNameAndCodeW(a,c,xjCityName,xjCityCode,b);break}}function cityCodeArryByProCode(a){switch(a){case 1:return fjCityCode;case 2:return beiJingCityCode;case 3:return shangHaiCityCode;case 4:return jsCityCode;case 5:return zjCityCode;case 6:return awCityCode;case 7:return jxCityCode;case 8:return sdCtiyCode;case 9:return heNanCityCode;case 10:return huBeiCtiyCode;case 11:return huNanCityCode;case 12:return gdCityCode;case 13:return gxCityCode;case 14:return haiNanCityCode;case 15:return chongQinCityCode;case 16:return yunNanCityCode;case 17:return tjCityCode;case 18:return heBeibCityCode;case 19:return sxCityCode;case 20:return nmgCityCode;case 21:return lnCityCode;case 22:return jlCityCode;case 23:return hljCityCode;case 24:return scCityCode;case 25:return gzCityCode;case 26:return xzCityCode;case 27:return sxiCityCode;case 28:return gsCityCode;case 29:return qhCityCode;case 30:return nxCityCode;case 31:return xjCityCode}}function cityNameArryByProCode(a){switch(a){case 1:return fjCityName;case 2:return beiJingCityName;case 3:return shangHaiCityName;case 4:return jsCityName;case 5:return zjCityName;case 6:return awCityName;case 7:return jxCityName;case 8:return sdCtiyName;case 9:return heNanCityName;case 10:return huBeiCtiyName;case 11:return huNanCityName;case 12:return gdCityName;case 13:return gxCityName;case 14:return haiNanCityName;case 15:return chongQinCityName;case 16:return yunNanCityName;case 17:return tjCityName;case 18:return heBeibCityName;case 19:return sxCityName;case 20:return nmgCityName;case 21:return lnCityName;case 22:return jlCityName;case 23:return hljCityName;case 24:return scCityName;case 25:return gzCityName;case 26:return xzCityName;case 27:return sxiCityName;case 28:return gsCityName;case 29:return qhCityName;case 30:return nxCityName;case 31:return xjCityName}}function initCityNameAndCode(c,d,a,b){for(i=0;i<a.length;i++){var e=new Option(a[i],b[i]);d.options.add(e)}}function initCityNameAndCodeW(c,e,a,b,d){for(i=0;i<a.length;i++){var f=new Option(a[i],b[i]);if(d!=null&&d==b[i]){f.selected=true}e.options.add(f)}}function getprovinceNameByCode(d){var a=0;var c=povinceCode.length;for(var b=0;b<c;b++){if(povinceCode[b]==d){a=b;break}}return provinceNames[a]}function getCityName(e,f){var g=cityCodeArryByProCode(e);var a=cityNameArryByProCode(e);var b=0;var d=g.length;for(var c=0;c<d;c++){if(f==g[c]){b=c;break}}return a[b]}var professionCode=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22];var professionName=["政府机关/干部","邮电通信","计算机","网络","商业/贸易","银行/金融/证劵/保险/投资","税务","咨询","社会服务","旅游/饭后","健康/医疗服务","房地产","交通服务","法律/司法","文化/娱乐/体育","媒介/广告","科研/教育","农业/渔业/林业/畜牧业","矿业/制造业","学生","自由职业","其他"];function getProfession(d){var a=0;var c=professionCode.length;for(var b=0;b<c;b++){if(professionCode[b]==d){a=b;break}}return professionName[a]}function getCtiyJson(e){var f=cityCodeArryByProCode(e);var a=cityNameArryByProCode(e);var d=f.length;var c="[";for(var b=0;b<d;b++){c+='{"value":"'+f[b]+'","text":"'+a[b]+'"},'}if(d>=1){c=c.substring(0,c.length-1)}c+="]";return c}Ext.namespace("com.base");com.base.ZhidanForm=Ext.extend(Ext.ux.BaseForm,{isShow:false,getItems:function(){return[{border:false,frame:false,layout:"column",width:800,items:[{columnWidth:0.33,layout:"form",labelAlign:"right",labelWidth:55,border:false,frame:false,items:[{anchor:"100%",xtype:"textfield",fieldLabel:"制单人",name:"createUserName",id:"createUserName",readOnly:true,value:g_userName},{xtype:"hidden",fieldLabel:"制单人",name:"createUserId",id:"createUserId",width:140,readOnly:true,value:g_userId}]},{columnWidth:0.33,layout:"form",labelAlign:"right",labelWidth:55,border:false,frame:false,items:[{anchor:"100%",xtype:"datefield",fieldLabel:"制单时间",name:"createDate",id:"createDateEd",format:"Y-m-d H:i:s",readOnly:true,value:new Date()}]},{columnWidth:0.33,layout:"form",labelAlign:"right",labelWidth:55,border:false,frame:false,items:[{anchor:"100%",xtype:"textfield",fieldLabel:"制单组织",name:"createOrgName",id:"createOrgName",readOnly:true,value:g_orgName},{xtype:"hidden",fieldLabel:"制单组织",name:"createOrgCd",id:"createOrgCd",width:140,readOnly:true,value:g_orgId}]}]}]}});Ext.reg("zhidanForm",com.base.ZhidanForm);function g_setBoxById(c,d,a){var b=Ext.getCmp(c);b.setValue(d);b.setRawValue(d);if(b.hiddenField){b.hiddenField.value=a}}function g_setFocusById(b){var a=Ext.getCmp(b);a.focus(false,100)}function g_setFldById(c,b){var a=Ext.getCmp(c);a.setValue(b)}function g_getBoxValById(b){var a=Ext.getCmp(b);if(a.hiddenField){return a.hiddenField.value}else{return a.getValue()}}function g_getValueById(b){var a=Ext.getCmp(b);return a.getValue()}function g_canModify(b,a,d){var e=Ext.getCmp(b);var c=e.getSelectionModel().getSelections();if(c.length==0){top.Ext.Msg.alert("提示信息","请您至少选择一条记录.")}else{if(c.length>1){top.Ext.Msg.alert("提示信息","只能选择一条记录.")}else{if(c.length==1){var f=c[0].get(a);if(f==3||f==1){return true}else{top.Ext.Msg.alert("提示信息","待提交审批或审批不通过才能"+d+".")}}}}return false}var g_gridRendererFun=function(c){var b=this.editor;var a=b.store;var d="";a.each(function(e){var f=e.get("value");if(f==c){g_setBoxVal(b,e.get("text"),f);d=e.get("text");return}});return d};function h_arrayToStrFun(c){var d="";if(Ext.isEmpty(c)){return d}var b=c.length;if(b>0){for(var a=0;a<b;a++){d+=c[a]+","}d=d.substr(0,d.length-1)}return d}function g_loadFrmDataFun(h,g){if(h==null||typeof h=="undefined"){return false}var a=h.getForm();if(a==null){return false}var f=a.items.keys;for(var d=0;d<f.length;d++){var e=f[d];var c=a.findField(e);if(c!=null&&typeof c!="undefined"){var b=(e).replace("Ed1","");b=b.replace("Ed","");b=b.replace("Txt","");c.setValue(g[b])}}}function g_getSelRowJsonData(d){var a=d.getSelectionModel().getSelections();var c="[";var f=a.length;if(f>0){var e=d.store.fields.keys;for(var b=0;b<f;b++){var g=a[b].data;c+=Ext.util.JSON.encode(g)+","}c=c.substr(0,c.length-1)}c+="]";return c}function g_loadJosnData(strUrl,postData,successFun,vMsg,isLoadMask){var vLoadMask=null;vMsg=Ext.getCmp(vMsg)?"获取":vMsg;if(isLoadMask){vLoadMask=new top.Ext.LoadMask(top.Ext.getBody(),{msg:"正在+"+vMsg+"数据，请稍后..."});vLoadMask.show()}Ext.Ajax.request({url:strUrl,method:"POST",params:postData,scope:this,success:function(response){if(isLoadMask){vLoadMask.hide()}var vResponse=eval("("+response.responseText+")");if(vResponse.success){var data=vResponse.DATA;if(typeof data=="undefined"){data=vResponse.data}new successFun(data)}else{if(response.responseText){if((response.responseText).indexOf("success")>=0){var vResponse=eval("("+response.responseText+")");g_showTip("错误提示",vResponse.msg,Ext.MessageBox.ERROR)}else{g_showTip("错误提示",response.responseText,Ext.MessageBox.ERROR)}}else{g_showTip("提示",vMsg+"失败")}}if(isLoadMask){delete vLoadMask}},failure:function(response){if(isLoadMask){vLoadMask.hide()}if(response.responseText){if((response.responseText).indexOf("success")>=0){var vResponse=eval("("+response.responseText+")");g_showTip("错误提示",vResponse.vMsg,Ext.MessageBox.ERROR)}else{g_showTip("错误提示",response.responseText,Ext.MessageBox.ERROR)}}else{g_showTip("提示","获取数据失败")}if(isLoadMask){delete vLoadMask}}})}String.prototype.replaceAll=function(a,b){return this.replace(new RegExp(a,"gm"),b)};function getWeekOfYear(p){var c=strToDate(p);var g=new Array(31,28,31,30,31,30,31,31,30,31,30,31);var k=0;var m=false;var d=false;var q=false;var n=0;if(c.getYear()>=2000){n=c.getYear()}else{n=c.getYear()+1900}var j=c.getMonth();var o=c.getDate();var b=c.getDay();if(n%4==0){m=true}for(var e=0;e<g.length;e++){if(e<j){if(m&&e==1){k=k+29}else{k=k+g[e]}}if(e==j){k=k+o}}var h=new Date();h.setYear(n);h.setMonth(0);h.setDate(1);if(h.getDay()==0){q=true}var f=k;if(!d){f=f+h.getDay()}if(!q){f=f+(7-b-1)}var a=0;if(f%7==0){a=parseInt(f/7)}else{a=parseInt(f/7)+1}if(a<10){return"0"+a}return a}function strToDate(a){newsdate=a.replace(/-0/gi,"-");var b=newsdate.split(/[-\s:]/);if(b.length>3){if(b.length>5){return new Date(b[0],parseInt(b[1])-1,b[2],b[3],b[4],b[5])}else{return new Date(b[0],parseInt(b[1])-1,b[2],b[3],b[4],"00")}}else{return new Date(b[0],parseInt(b[1])-1,b[2],"00","00","00")}}function g_reportFun(n,m,h,a,o,c){var g=Ext.getCmp(n).getForm();var b=g.getValues();var f="";for(var e in b){f+=e+","}if(Ext.isEmpty(o)){o=""}if(Ext.isEmpty(c)){c=""}f+="curUserId,curUserOrgCd,rootOrgName,expType"+o;var d=Ext.urlEncode(b);d+="&curUserId="+g_userId+"&curUserOrgCd="+g_orgId+c;var j=G_ROOT_PATH+"/report/printPdf.jsp?reportName="+h+"&paramNames="+f+"&rootOrgName="+encodeURIComponent(g_rootOrgName)+"&"+d+"&expType="+m;if(m=="PDF"){parent.closeTab(h);parent.addTabUrl(h,a,j)}else{window.open(j)}}function g_isNoRepeat(g,f,a){var c="@@%$##(*&&@,";var h=c;var e=g.store.getCount();for(var b=0;b<e;b++){var d=c+g.store.getAt(b).get(f)+c;if(h.indexOf(d)>-1){top.Ext.Msg.alert("提示信息",a+":'"+g.store.getAt(b).get(f)+"'重复了,请重新维护");return false}h+=g.store.getAt(b).get(f)+c}return true}function g_docPostSp(e,b,m,f,a,n){var p=Ext.getCmp(e);var d=p.getSelectionModel().getSelections();if(d.length==0){top.Ext.Msg.alert("提示信息","请您至少选择一条记录.")}else{if(d.length>0){var c="{spInfoList:[";for(var g=0;g<d.length;g++){var j=d[g].get(f);if(j==3||j==1){var h=d[g].get(m);var k=d[g].get(b);c+='{tableNo:"'+a+'",pkVal:"'+k+'",noVal:"'+h+'",recId:"",yesNo:"",spRemark:""},'}else{top.Ext.Msg.alert("提示信息","选中的记录状态不是“待提交审批”或“审批不通过”，不能提交审批！");return false}}c=c.substring(0,c.length-1)+"]}";var o=function(){var q=Ext.getCmp(n).getForm().getValues();Ext.getCmp(e).queryData(q)};top.g_postJsonData(G_ROOT_PATH+"/spPostWeb.cll?method=postSp",c,o,"提交")}}}function g_docPostBack(e,b,m,f,a,n){var p=Ext.getCmp(e);var d=p.getSelectionModel().getSelections();if(d.length==0){top.Ext.Msg.alert("提示信息","请您至少选择一条记录.")}else{if(d.length>=1){var c="{spInfoList:[";for(var g=0;g<d.length;g++){var j=d[g].get(f);if(j==0||j==5){var h=d[g].get(m);var k=d[g].get(b);c+='{tableNo:"'+a+'",pkVal:"'+k+'",noVal:"'+h+'",recId:"",yesNo:"",spRemark:""},'}else{top.Ext.Msg.alert("提示信息","选中的记录状态不是“审批通过”或“反审批不通过”，不能提交改单申请！");return false}}c=c.substring(0,c.length-1)+"]}";var o=function(){var q=Ext.getCmp(n).getForm().getValues();Ext.getCmp(e).queryData(q)};top.g_postJsonData(G_ROOT_PATH+"/spPostWeb.cll?method=postBack",c,o,"提交")}}}function g_viewSpInfo(b,a){var d=Ext.getCmp(b);var c=d.getSelectionModel().getSelections();if(c.length==0){top.Ext.Msg.alert("提示信息","请您至少选择一条记录.")}else{if(c.length>1){top.Ext.Msg.alert("提示信息","只选择一条记录.")}else{if(c.length==1){var e=c[0].get(a);new spRecordWin(e)}}}}function getTextJsonByValue(d,e){if(d==null){return e}var c=d.length;var b=e;for(var a=0;a<c;a++){if((d[a]).value==e){b=(d[a]).text;break}}return b}function g_loadGridData(a,d,c){var b=Ext.getCmp(a);b.store.baseParams=d;b.store.load({callback:c})}function g_setBoxVal(b,c,a){b.setValue(c);b.setRawValue(c);if(b.hiddenField){b.hiddenField.value=a}}function g_setBoxValue(a,c,b){if(a!=null){a.setValue(b);a.setRawValue(b);if(a.hiddenField){a.hiddenField.value=c}}}function g_setOtherValue(a,c,b){if(a!=null){a.setValue(b);a.setRawValue(b);if(a.hiddenField){a.hiddenField.value=c}}}function g_localCombox(b,j,k,m,h,a,c,d){var g=false;if(typeof c!="undefined"&&c!=null){g=c}var f=true;if(typeof d!="undefined"&&d!=null){f=d}var e=false;if(typeof a!="undefined"&&a!=null){e=a}return{disabled:e,editable:g,tabIndex:b,allowBlank:f,xtype:"baseComBox",jsonData:h,fieldLabel:j,hiddenName:m,name:k,id:k}}function g_getRecListFldArr2(e,a){vCount=e.length;var c="";var d=new Array();if(vCount>0){for(var b=0;b<vCount;b++){var f=e[b];if(d[f.get(a)]!=1){c+=f.get(a)+",";d[f.get(a)]=1}}c=c.substr(0,c.length-1)}d=null;return c}function g_countGridFldVal(f,a,h){var c=f.store;vCount=c.getCount();var e="";var b=0;if(vCount>0){for(var d=0;d<vCount;d++){var g=c.getAt(d);if(g.get(a)==h){b++}}}return b}function g_countGridFldVal(b,c,d,j){var a=b.store;vCount=a.getCount();var h="";var g=0;if(vCount>0){for(var f=0;f<vCount;f++){var e=a.getAt(f);if(e.get(c)==d&&j!=f){g++}}}return g}function g_loadFormData(c,a,b){(Ext.getCmp(a).getForm()).load({url:c,waitMsg:"正在载入数据...",success:function(d,e){if(typeof b!="undefined"){new b(d,e)}},failure:function(d,e){g_showTip("异常",e.result.msg,Ext.MessageBox.ERROR)}})}function g_setBusiNo(codeCd,fldObj){Ext.Ajax.request({url:G_ROOT_PATH+"/genBusNoWeb.cll?method=getBusNo&codeCd="+codeCd,method:"POST",scope:this,success:function(response){var vResponse=eval("("+response.responseText+")");if(vResponse.success&&vResponse.pk!="false"&&vResponse.pk!="null"){fldObj.setValue(vResponse.pk);fldObj.setDisabled(true)}else{fldObj.setDisabled(false)}},failure:function(response){fldObj.setDisabled(false)}})}function g_formValToGrid(b,f,e){var c=b.colArr;for(var a=0;a<c.length;a++){var d=c[a];if(typeof e[c[a]]=="undefined"){d=c[a]+"1"}if(typeof e[d]!="undefined"){f.set(c[a],e[d])}}}function g_gridDataToForm(b,f,h){var m=b.colArr;var a=f;for(var e=0;e<m.length;e++){var c=h.get(m[e]);var k=m[e];var d=f.findField(k);if(d==null||typeof d=="undefined"){d=f.findField(k+"1")}if(d!=null&&typeof d!="undefined"){d.setValue(c)}var j=f.findField(m[e]+"Txt");if(j!=null&&typeof j!="undefined"){if(m[e]=="docStatusCd"){try{j.setValue(statsRender(c))}catch(g){}}else{j.setValue(c)}}}}function g_getAddBlank(c){var b=new Array();b[0]={value:"",text:"全部"};for(var a=0;a<c.length;a++){b[b.length]=c[a]}return b}function g_getGridFldArr(e,a){var b=e.store;vCount=b.getCount();var d="";var f=new Array();if(vCount>0){for(var c=0;c<vCount;c++){var g=b.getAt(c);if(f[g.get(a)]!=1){d+="'"+g.get(a)+"',";f[g.get(a)]=1}}d=d.substr(0,d.length-1)}f=null;return d}function g_getRecListFldArr(e,a){vCount=e.length;var c="";var d=new Array();if(vCount>0){for(var b=0;b<vCount;b++){var f=e[b];if(d[f.get(a)]!=1){c+="'"+f.get(a)+"',";d[f.get(a)]=1}}c=c.substr(0,c.length-1)}d=null;return c}function g_getRecJsonData(c){var b="[";vCount=c.length;if(vCount>0){for(var a=0;a<vCount;a++){b+=Ext.util.JSON.encode(c[a].data)+","}b=b.substr(0,b.length-1)}b+="]";return b}function g_getGridJsonData(d){var a=d.store;var c="[";vCount=a.getCount();if(vCount>0){for(var b=0;b<vCount;b++){c+=Ext.util.JSON.encode(a.getAt(b).data)+","}c=c.substr(0,c.length-1)}c+="]";return c}function g_getGridFldMaxVal(d,a){var b=d.store;var e=0;vCount=b.getCount();if(vCount>0){for(var c=0;c<vCount;c++){var f=(b.getAt(c)).get(a);if(e<Number(f)){e=f}}}return Number(e)}function g_getGridFldOptVal(e,b,a){var c=e.store;vCount=c.getCount();if(vCount>0){for(var d=0;d<vCount;d++){var f=(c.getAt(d)).get(b);if(!(Number(f)>a)){return false}}}return true}function g_gridAddRow(b,d){var c=new b.store.recordType();c.data={};var e=b.store.fields.keys;for(var a=0;a<e.length;a++){c.data[e[a]]=""}b.store.insert(0,c);if(d){b.stopEditing();(b.getSelectionModel()).selectFirstRow();b.startEditing(0,0)}return c}function g_gridSelRecData(a){var b=a.getSelectionModel().getSelections();if(b.length==0){Ext.Msg.alert("提示信息","请您至少选择一条记录.");return -1}else{if(b.length>1){Ext.Msg.alert("提示信息","对不起只能选择一条记录.");return -1}else{if(b.length==1){return b[0]}}}}function g_gridDelSelData(a){var b=a.getSelectionModel().getSelections();if(b.length==0){Ext.Msg.alert("提示信息","请您至少选择一条记录.")}else{if(b.length>1){Ext.Msg.alert("提示信息","对不起只能选择一条记录.")}else{if(b.length==1){a.store.remove(b[0]);return b[0]}}}}function g_gridIsEmpty(b){var a=b.store;var c=a.getCount();if(c==0){return true}else{return false}}function g_gridDelData(d,h,c){var a=d.store;var g=a.getCount();var b=new Array();if(g>0){for(var f=0;f<g;f++){var j=a.getAt(f);if(!(typeof j!="undefined"&&j.get(h)==c)){b[b.length]=j}}a.removeAll();for(var e=0;e<b.length;e++){a.insert(0,b[e])}}}function g_showTip(h,b,f,a,c,g,j){var d=260;if(typeof a!="undefined"){d=a}var e=180;if(typeof c!="undefined"){e=c}viconImg=Ext.MessageBox.INFO;if(typeof f!="undefined"){viconImg=f}Ext.MessageBox.show({title:h,msg:b,buttons:Ext.MessageBox.OK,fn:g,scope:j,width:d,heigth:e,icon:viconImg,closable:true});delete d;delete e}function g_clearIframe(a){if(window.frames[a]!=null){try{window.frames[a].destroyDoc()}catch(c){}try{window.frames[a].document.src="about:blank"}catch(c){}try{window.frames[a].document.clear()}catch(c){}try{((document.getElementById(a)).parentNode).outerHTML=""}catch(c){}try{((document.getElementById(a)).parentNode).outerText=""}catch(c){}try{((document.getElementById(a)).parentNode).innerHTML=""}catch(c){}try{((document.getElementById(a)).parentNode).innerText=""}catch(c){}try{var b=document.getElementById(a);b.removeNode(true);b=null}catch(c){}try{CollectGarbage()}catch(c){}}}function g_forwardLogin(){top.document.location=G_ROOT_PATH+"/login.jsp"}function g_deleteData(a,b){Ext.Ajax.request({url:a,success:b,failure:function(c){var d=Ext.decode(c.responseText);g_showTip("操作失败",form.responseText,Ext.MessageBox.ERROR)}})}function g_formLoadData(a,d,b){var c=b;if(typeof b=="undefined"){c=function(e,f){}}(Ext.getCmp(a).getForm()).load({url:d,waitMsg:"正在载入数据...",success:c,failure:function(e,f){g_showTip("载入数据失败",f.result.msg,Ext.MessageBox.ERROR)}})}function g_gridLoadPageData(gridId,params){var v_params="(Ext.getCmp('"+gridId+"')).store.baseParams={";for(var p in params){try{v_params+='"'+p+'":"'+encodeURIComponent(params[p])+'",'}catch(e){}}v_params+="aa:11}";eval(v_params);(Ext.getCmp(gridId)).store.load({params:{start:0,limit:g_grid_pageSize}})}function g_gridLoadData(gridId,params){var v_params="(Ext.getCmp('"+gridId+"')).store.baseParams={";for(var p in params){try{v_params+='"'+p+'":"'+encodeURIComponent(params[p])+'",'}catch(e){}}v_params+="aa:11}";eval(v_params);(Ext.getCmp(gridId)).store.load()}function g_postJsonData(strUrl,postData,successFun,msg){var vLoadMask=new top.Ext.LoadMask(top.Ext.getBody(),{msg:"正在保存，请稍后..."});vLoadMask.show();Ext.Ajax.request({url:strUrl,method:"POST",params:postData,scope:this,success:function(response){vLoadMask.hide();var vResponse=eval("("+response.responseText+")");if(vResponse.success){if(typeof msg=="undefined"){g_showTip("提示","保存成功")}else{g_showTip("提示",msg+"成功")}new successFun()}else{if(response.responseText){if((response.responseText).indexOf("success")>=0){var vResponse=eval("("+response.responseText+")");g_showTip("错误提示",vResponse.msg,Ext.MessageBox.ERROR)}else{g_showTip("错误提示",response.responseText,Ext.MessageBox.ERROR)}}else{if(typeof msg=="undefined"){g_showTip("提示","保存失败")}else{g_showTip("提示",msg+"失败")}}}delete vLoadMask},failure:function(response){vLoadMask.hide();if(response.responseText){if((response.responseText).indexOf("success")>=0){var vResponse=eval("("+response.responseText+")");g_showTip("错误提示",vResponse.msg,Ext.MessageBox.ERROR)}else{g_showTip("错误提示",response.responseText,Ext.MessageBox.ERROR)}}else{g_showTip("提示","保存失败")}delete vLoadMask}})}function g_postJsonData2(strUrl,postData,successFun,msg){var vLoadMask=new top.Ext.LoadMask(top.Ext.getBody(),{msg:"正在保存，请稍后..."});vLoadMask.show();Ext.Ajax.request({url:strUrl,method:"POST",params:postData,scope:this,success:function(response){vLoadMask.hide();var vResponse=eval("("+response.responseText+")");if(vResponse.success){if(typeof msg=="undefined"){top.Ext.Msg.alert("提示","保存成功")}else{if(msg!=-1){top.Ext.Msg.alert("提示",msg+"成功")}}new successFun()}else{if(response.responseText){if((response.responseText).indexOf("success")>=0){var vResponse=eval("("+response.responseText+")");top.Ext.Msg.alert("提示",vResponse.msg,Ext.MessageBox.ERROR)}else{top.Ext.Msg.alert("提示",response.responseText,Ext.MessageBox.ERROR)}}else{if(typeof msg=="undefined"){top.Ext.Msg.alert("提示","保存失败")}else{top.Ext.Msg.alert("提示",msg+"失败")}}}delete vLoadMask},failure:function(response){vLoadMask.hide();if(response.responseText){if((response.responseText).indexOf("success")>=0){var vResponse=eval("("+response.responseText+")");top.Ext.Msg.alert("提示",vResponse.msg,Ext.MessageBox.ERROR)}else{top.Ext.Msg.alert("提示",response.responseText,Ext.MessageBox.ERROR)}}else{top.Ext.Msg.alert("提示","保存失败")}delete vLoadMask}})}function g_AjaxRequest(strUrl,tipMsg){var strResponse=callXMLHTTPJson(strUrl,null);try{if(strResponse.indexOf(G_xmlNode_rtn+":")>=0){eval("var rtn=jsonObj."+G_xmlNode_rtn);eval("var msg=jsonObj."+G_xmlNode_msg);if(rtn==-1){g_showTip("错误提示",tipMsg,Ext.MessageBox.ERROR);return null}}return strResponse}catch(ex){alert("返回的数据不符合json格式");return null}}function g_edGridFieldValid(j,c,m){var o=j.getColumnModel();var a=j.store;for(var e=0;e<c.length;e++){var g=c[e];var h=g.fields.keys;for(var d=0;d<h.length;d++){var p=o.findColumnIndex(h[d]);var n=g.data[h[d]];if(p==-1){continue}var b=a.indexOfId(g.id);var f=o.getCellEditor(p).field;if(!f.validateValue(n)){g_showTip(m,"必须输入的列字段不能为空.");j.startEditing(b,p);return false}}}return true}function g_edGridFieldValid1(d,e){var a=d.getColumnModel();var b=d.store;var c=true;if(b.getCount()>0){b.each(function(h){var g=h.fields.keys;if(!c){return false}for(var j=0;j<g.length;j++){var m=a.findColumnIndex(g[j]);var p=h.data[g[j]];if(m==-1){continue}var o=b.indexOfId(h.id);var n=a.getCellEditor(m);if(n!=null&&typeof n!="undefined"&&typeof n.field!="undefined"){var f=n.field;if(!f.validateValue(p)){top.g_showTip(e,"必须输入的列字段不能为空.");d.startEditing(o,m);c=false;break}}}})}return c}function openFormWin(b,d,a,f,e,c){g_openNewWin(b,d,a,f,e,c)}function g_openNewWin(b,f,a,h,g,e){var d=500;var c=600;if(typeof f[0].win_width!="undefined"){d=f[0].win_width}if(typeof f[0].win_height!="undefined"){c=f[0].win_height}g_commonWin(b,f,d,c,"fit",h,g,a,e)}var openNewWin=null;var g_singleWin=null;var g_sglFlg=1;function g_CloseWin(b,a){if(typeof a!="undefined"){g_clearIframe(a)}top.openNewWin=null;openNewWin=Ext.getCmp(b);if(openNewWin!=null){if(g_sglFlg==0){openNewWin.hide()}else{Ext.destroy(openNewWin);g_destoryExt(openNewWin)}}openNewWin=null}function g_commonWin(f,d,a,j,c,b,h,e,g){if(g_sglFlg==0){g_commonSglWin(f,d,a,j,c,b,h,e,g)}else{g_commonNewWin(f,d,a,j,c,b,h,e,g)}}function g_commonNewWin(g,d,a,k,c,b,j,f,h){openNewWin=new Ext.Window({id:"winNewId",title:g,resizable:false,shadow:false,modal:true,closeAction:"destroy",closable:false,bodyStyle:"padding-top:6px;padding-left:6px",items:d,autoDestroy:true,width:a,layout:c,height:k+5});openNewWin.show();if(typeof b!="undefined"&&b!=null){if(j==1){g_setFormByUrl(b,d[0].id,h)}else{g_setFormByRec(b,d[0].id)}}try{top.Ext.get("flag").dom.value=f}catch(e){}try{Ext.get("flag").dom.value=f}catch(e){}}function g_commonSglWin(g,d,a,k,c,b,j,f,h){if(top.g_singleWin==null){top.g_singleWin=new Ext.Window({id:"winNewId",title:g,resizable:false,modal:true,closeAction:"hide",items:d,autoDestroy:true,border:false,frame:true,width:a,layout:c,height:k+5})}else{top.g_singleWin.removeAll();top.g_singleWin.add({layout:c,border:false,frame:false,items:d});top.g_singleWin.doLayout();top.g_singleWin.setTitle(g);top.g_singleWin.setSize(a,k+5)}top.g_singleWin.show();if(typeof b!="undefined"&&b!=null){if(j==1){g_setFormByUrl(b,d[0].id,h)}else{g_setFormByRec(b,d[0].id)}}try{top.Ext.get("flag").dom.value=f}catch(e){}try{Ext.get("flag").dom.value=f}catch(e){}}function g_setFormByUrl(c,a,b){(top.Ext.getCmp(a).getForm()).load({url:c,waitMsg:"正在载入数据...",success:function(d,e){if(typeof b!="undefined"){new b(d,e)}},failure:function(d,e){g_showTip("异常",e.result.msg,Ext.MessageBox.ERROR)}})}function g_curPageFrmLoad(b,a){(Ext.getCmp(a).getForm()).load({url:b,waitMsg:"正在载入数据...",success:function(c,d){},failure:function(c,d){g_showTip("异常",d.result.msg,Ext.MessageBox.ERROR)}})}function g_setFormByRec(b,a){if(b!=null){top.Ext.getCmp(a).getForm().loadRecord(b)}}function g_destoryExt(a){a.un("add",a.onAdd,this,{target:this});a.un("remove",a.onRemove,this,{target:this});if(a.items){a.items.each(function(b){if(b&&b.tabEl){Ext.get(b.tabEl).removeAllListeners();b.tabEl=null}},a)}if(a.rendered){Ext.destroy(a.view,a.loadMask)}if(a.header){a.header.removeAllListeners()}if(a.body){a.body.removeAllListeners()}if(a.strip){a.strip.removeAllListeners()}Ext.destroy(a.header,a.items,a.tbar,a.bbar,a.footer,a.body,a.bwrap,a.dd,a.buttons,a.fbar,a.stack,a.stripWrap,a.stripSpacer,a.strip,a.edge,a.leftRepeater,a.rightRepeater);delete a.header;delete a.items;delete a.tbar;delete a.bbar;delete a.footer;delete a.body;delete a.bwrap;delete a.dd;delete a.buttons;delete a.fbar;delete a.stack;delete a.stripWrap;delete a.stripSpacer;delete a.strip;delete a.edge;delete a.leftRepeater;delete a.rightRepeater;a.header=null;a.items=null;a.tbar=null;a.bbar=null;a.footer=null;a.body=null;a.bwrap=null;a.dd=null;a.buttons=null;a.fbar=null;a.stack=null;a.stripWrap=null;a.stripSpacer=null;a.strip=null;a.edge=null;a.leftRepeater=null;a.rightRepeater=null}function g_formLoadJsonData(d,c){if(Ext.getCmp(d)==null){return false}var f=Ext.getCmp(d).getForm();if(f==null){return false}for(var b in c){try{f.findField(b).setValue(c[b])}catch(a){}try{f.findField(b+"1").setValue(c[b])}catch(a){}try{f.findField(b+"M").setValue(c[b])}catch(a){}try{f.findField(b+"Txt").setValue(c[b])}catch(a){}}}function g_getCodeTxtZh(a,c){for(var b=0;b<a.length;b++){if((a[b]).value==c){return(a[b]).text}}return c}function g_getCodeOthValue(a,c){for(var b=0;b<a.length;b++){if((a[b]).value==c){return(a[b]).otherValue}}return"notFound"}function g_getTxtOthValue(a,c){for(var b=0;b<a.length;b++){if((a[b]).text==c){return(a[b]).otherValue}}return"notFound"}function g_compareDate(e,d){var g=e.substring(5,e.lastIndexOf("-"));var c=e.substring(e.length,e.lastIndexOf("-")+1);var h=e.substring(0,e.indexOf("-"));var b=d.substring(5,d.lastIndexOf("-"));var a=d.substring(d.length,d.lastIndexOf("-")+1);var f=d.substring(0,d.indexOf("-"));if(Date.parse(g+"/"+c+"/"+h)>Date.parse(b+"/"+a+"/"+f)){return true}else{return false}}function FloatAdd(f,d){var c,b,a;try{c=f.toString().split(".")[1].length}catch(g){c=0}try{b=d.toString().split(".")[1].length}catch(g){b=0}a=Math.pow(10,Math.max(c,b));return(f*a+d*a)/a}function FloatSub(f,d){var c,b,a,h;try{c=f.toString().split(".")[1].length}catch(g){c=0}try{b=d.toString().split(".")[1].length}catch(g){b=0}a=Math.pow(10,Math.max(c,b));h=(c>=b)?c:b;return((f*a-d*a)/a).toFixed(h)}function FloatMul(d,b){var a=0,f=d.toString(),c=b.toString();try{a+=f.split(".")[1].length}catch(g){}try{a+=c.split(".")[1].length}catch(g){}return Number(f.replace(".",""))*Number(c.replace(".",""))/Math.pow(10,a)}function FloatDiv(arg1,arg2){var t1=0,t2=0,r1,r2;try{t1=arg1.toString().split(".")[1].length}catch(e){}try{t2=arg2.toString().split(".")[1].length}catch(e){}with(Math){r1=Number(arg1.toString().replace(".",""));r2=Number(arg2.toString().replace(".",""));return(r1/r2)*pow(10,t2-t1)}}function round2(number,fractionDigits){with(Math){return round(number*pow(10,fractionDigits))/pow(10,fractionDigits)}}function genPk(){var b=G_ROOT_PATH+"/pkWeb.cll?method=genPk";var a=PostInfoJson(b);if(a!=null){if(a.success){return a.pkVal}else{return null}}else{return null}}com.base.WmsLocTree=Ext.extend(Ext.ux.BaseTree,{getRootNode:function(){return{nodeType:"async",text:"仓库树",draggable:false,id:"0"}},getTreeLoader:function(){return new Ext.tree.TreeLoader({dataUrl:G_ROOT_PATH+"/basWarehouseWeb.cll?method=getJsonTree",listeners:{beforeload:function(b,a){b.baseParams.parentId=(a.id==0?0:a.attributes.id)}}})},nodeExClick:function(a){this.setValue(a.text);this.setRawValue(a.text);if(!Ext.isEmpty(this.hiddenField)){this.hiddenField.value=a.id}if(this.setOtherField!=undefined){this.setOtherField(selRec)}},getTbar:function(){return[]}});Ext.reg("wmsLocTree",com.base.WmsLocTree);com.base.AllUserComBox=Ext.extend(Ext.ux.BaseGridBox,{setOtherCombo:function(a){return null},gridDblClick:function(a,d,b){var c=a.store.getAt(d);if(c!=null){this.setValue(c.get("userId"));this.setRawValue(c.get("userName"));if(!Ext.isEmpty(this.hiddenField)){this.hiddenField.value=c.get("userId")}if(this.setOtherField!=undefined){this.setOtherField(c)}}this.collapse()},getCol:function(){return["userId","userName"]},getColTitle:function(){return[{header:"姓名",dataIndex:"userName"}]},getQryUrl:function(){return this.rootPath+"/sysUser.cll?method=queryPage"},getPkField:function(){return"userId"}});Ext.reg("AllUserComBox",com.base.AllUserComBox);com.base.MulAllUserComBox=Ext.extend(Ext.ux.BaseGridBox,{splitNo:",",isSingleSel:false,setVal:function(a,b){this.setValue(a);this.setRawValue(b);if(this.hiddenField){this.hiddenField.value=a}},selFun:function(){var e=this.gridPnl.getSelectionModel().getSelections();var b=e.length;var c="",d="";for(var a=0;a<b;a++){c=c+e[a].get("userId")+this.splitNo;d=d+e[a].get("userName")+this.splitNo}if(b>=1){c=c.substr(0,c.length-(this.splitNo).length);d=d.substr(0,d.length-(this.splitNo).length)}this.setVal(c,d);this.collapse()},setOtherCombo:function(a){return null},gridDblClick:function(a,d,b){var c=a.store.getAt(d);if(c!=null){this.setVal(c.get("userId"),c.get("userName"))}this.collapse()},getCol:function(){return["userId","userName"]},getColTitle:function(){return[{header:"姓名",dataIndex:"userName"}]},getQryUrl:function(){return this.rootPath+"/sysUser.cll?method=queryPage"},getPkField:function(){return"userId"}});Ext.reg("MulAllUserComBox",com.base.MulAllUserComBox);com.base.CustCatalogBox=Ext.extend(Ext.ux.BaseTreeBox,{rootPath:G_ROOT_PATH,setOtherField:function(a){return null},otherBoxId:"",getTreeUrl:function(){return this.rootPath+"/crmCustomerWeb.cll?method=getCustCatalogTree"},otherSet:function(a){var b=Ext.getCmp(this.otherBoxId);if(b!=null){b.clearValue();b.store.baseParams={orgId:a.id};b.store.load()}}});Ext.reg("CustCatalogBox",com.base.CustCatalogBox);com.base.CrmCustBox=Ext.extend(Ext.ux.BaseGridBox,{catalogCd:"all",setOtherCombo:function(a){return null},gridDblClick:function(a,d,b){var c=a.store.getAt(d);if(c!=null){this.setValue(c.get("custCode"));this.setRawValue(c.get("custName"));if(!Ext.isEmpty(this.hiddenField)){this.hiddenField.value=c.get("custCode")}if(this.setOtherField!=undefined){this.setOtherField(c)}}this.collapse()},getCol:function(){return["custCode","catalogCd","custName","custNameCn","custNameEn","custContact","custTel","custAddress"]},getColTitle:function(){if("G"==this.catalogCd){return[{header:"供应商编码",dataIndex:"custCode",width:120},{header:"供应商名称",dataIndex:"custName",width:200}]}else{return[{header:"客商编码",dataIndex:"custCode",width:120},{header:"客商名称",dataIndex:"custName",width:200}]}},getQryUrl:function(){return this.rootPath+"/crmCustomerWeb.cll?method=qryCrmCust&catalogCd="+this.catalogCd},getPkField:function(){return"custCode"}});Ext.reg("CrmCustBox",com.base.CrmCustBox);com.base.CustActBox=Ext.extend(Ext.ux.BaseGridBox,{catalogCd:"all",filterFld:"",keyWordQry:function(a){if(this.filterFld!=""){var c=Ext.getCmp(this.filterFld);if(c.hiddenField){this.filterVal=c.hiddenField.value}else{this.filterVal=c.getValue()}if((this.filterVal).length==0){this.filterVal=this.fltDefaultVal}}this.gridPnl.store.baseParams={keyWord:this.getRawValue(),custCode:this.filterVal};var b=this;this.gridPnl.store.load({params:{start:0,limit:g_grid_pageSize}})},gridDblClick:function(a,d,b){var c=a.store.getAt(d);if(c!=null){this.setValue(c.get("custCode"));this.setRawValue(c.get("custName"));if(!Ext.isEmpty(this.hiddenField)){this.hiddenField.value=c.get("custCode")}if(this.setOtherField!=undefined){this.setOtherField(c)}}this.collapse()},getCol:function(){return["custCode","catalogCd","custName","custNameCn","custNameEn","custContact","custTel","custAddress","taxNo","bankName","accountName","accountNo"]},getColTitle:function(){return[{header:"客商编码",dataIndex:"custCode",width:120},{header:"客商名称",dataIndex:"custName",width:200},{header:"开户银行",dataIndex:"bankName",width:180},{header:"户名",dataIndex:"accountName",width:150},{header:"账号",dataIndex:"accountNo",width:180}]},getQryUrl:function(){return this.rootPath+"/crmCustomerWeb.cll?method=qryCrmCustAct&catalogCd="+this.catalogCd},getPkField:function(){return null}});Ext.reg("CustActBox",com.base.CustActBox);com.base.MatSelBox=Ext.extend(Ext.ux.BaseGridBox,{type:"0",setOtherCombo:function(a){return null},gridDblClick:function(a,d,b){var c=a.store.getAt(d);if(c!=null){this.setValue(c.get("goodNo"));this.setRawValue(c.get("goodName"));if(!Ext.isEmpty(this.hiddenField)){this.hiddenField.value=c.get("goodNo")}if(this.setOtherField!=undefined){this.setOtherField(c)}}this.collapse()},getCol:function(){return["goodType","matNo","goodWmsId","heightNum","widthNum","minUnit","sizeUnit","unitWeigth","goodNo","goodName","specId","unitWeigth","specNo","spec","modelNum","wmsinfoId","goodWmsNo","goodWmsName","supplierId","supplierName"]},getColTitle:function(){if(this.type=="1"){return[{header:"存货编号",dataIndex:"goodWmsNo"},{header:"存货名称",dataIndex:"goodWmsName"},{header:"规格",dataIndex:"spec"},{header:"型号",dataIndex:"modelNum"},{header:"克重",dataIndex:"unitWeigth"},{header:"供应商",dataIndex:"supplierName"},{header:"物料编码",dataIndex:"goodNo"},{header:"物料名称",dataIndex:"goodName"},{header:"物料类型",dataIndex:"goodType"}]}else{return[{header:"产品编码",dataIndex:"goodNo"},{header:"产品名称",dataIndex:"goodName"},{header:"规格",dataIndex:"spec"},{header:"型号",dataIndex:"modelNum"}]}},getQryUrl:function(){return this.rootPath+"/goodInfoWeb.cll?method=qryGoodBox&status=0&type="+this.type},getPkField:function(){return null}});Ext.reg("MatSelBox",com.base.MatSelBox);com.base.MulSelGrdBox=Ext.extend(Ext.ux.BaseGridBox,{rootPath:G_ROOT_PATH,optionNo:"",splitNo:",",isSingleSel:true,setVal:function(a,b){this.setValue(a);this.setRawValue(b);if(this.hiddenField){this.hiddenField.value=a}},selFun:function(){var e=this.gridPnl.getSelectionModel().getSelections();var b=e.length;var c="",d="";for(var a=0;a<b;a++){c=c+e[a].get("value")+this.splitNo;d=d+e[a].get("text")+this.splitNo}if(b>=1){c=c.substr(0,c.length-(this.splitNo).length);d=d.substr(0,d.length-(this.splitNo).length)}this.setVal(c,d);this.collapse()},gridDblClick:function(a,d,b){var c=a.store.getAt(d);if(c!=null){this.setVal(c.get("value"),c.get("text"))}this.collapse()},getCol:function(){return["valueId","optionNo","value","text","sort"]},getColTitle:function(){return[{header:"名称",dataIndex:"text",width:200}]},getQryUrl:function(){return this.rootPath+"/boxOptionWeb.cll?method=getSysOption&optionNo="+this.optionNo},getPkField:function(){return"valueId"}});Ext.reg("MulSelGrdBox",com.base.MulSelGrdBox);com.base.CustLinkBox=Ext.extend(Ext.ux.BaseGridBox,{filterFld:"",keyWordQry:function(a){if(this.filterFld!=""){var c=Ext.getCmp(this.filterFld);if(c.hiddenField){this.filterVal=c.hiddenField.value}else{this.filterVal=c.getValue()}if((this.filterVal).length==0){this.filterVal=this.fltDefaultVal}}this.gridPnl.store.baseParams={keyWord:this.getRawValue(),custCode:this.filterVal};var b=this;this.gridPnl.store.load({params:{start:0,limit:g_grid_pageSize}})},gridDblClick:function(a,d,b){var c=a.store.getAt(d);if(c!=null){this.setValue(c.get("address"));this.setRawValue(c.get("address"));if(!Ext.isEmpty(this.hiddenField)){this.hiddenField.value=c.get("address")}if(this.setOtherField!=undefined){this.setOtherField(c)}}this.collapse()},getCol:function(){return["fax","custCode","contact","sex","tel","address","remarks","keyid"]},getColTitle:function(){return[{header:"收发货地址",dataIndex:"address",width:200},{header:"联系人",dataIndex:"contact"},{header:"电话",dataIndex:"tel"}]},getQryUrl:function(){return G_ROOT_PATH+"/boxOptionWeb.cll?method=getCustLink"},getPkField:function(){return null}});Ext.reg("CustLinkBox",com.base.CustLinkBox);com.base.jointBox=Ext.extend(Ext.ux.BaseGridBox,{optionNo:"",setOtherCombo:function(a){return null},gridDblClick:function(a,d,b){var c=a.store.getAt(d);if(c!=null){this.setValue(c.get("value"));this.setRawValue(c.get("text"));if(!Ext.isEmpty(this.hiddenField)){this.hiddenField.value=c.get("value")}if(this.setOtherField!=undefined){this.setOtherField(c)}}this.collapse()},getCol:function(){return["text","value"]},getColTitle:function(){return[{width:140,header:"联别",dataIndex:"text"}]},getQryUrl:function(){return this.rootPath+"/basCraftWeb.cll?method=getJoint&optionNo="+this.optionNo},getPkField:function(){return"keyid"}});Ext.reg("JointBox",com.base.jointBox);com.base.CraftBox=Ext.extend(Ext.ux.BaseGridBox,{setOtherCombo:function(a){return null},gridDblClick:function(a,d,b){var c=a.store.getAt(d);if(c!=null){this.setValue(c.get("craftCode"));this.setRawValue(c.get("craftName"));if(!Ext.isEmpty(this.hiddenField)){this.hiddenField.value=c.get("craftCode")}if(this.setOtherField!=undefined){this.setOtherField(c)}}this.collapse()},getCol:function(){return["craftCode","craftName","craftType"]},getColTitle:function(){return[{header:"工序编码",dataIndex:"craftCode",width:120},{header:"工序名称",dataIndex:"craftName",width:120}]},getQryUrl:function(){return this.rootPath+"/basCraftWeb.cll?method=getBasCraft"},getPkField:function(){return"craftCode"}});Ext.reg("CraftBox",com.base.CraftBox);com.base.MachineModelBox=Ext.extend(Ext.ux.BaseGridBox,{qryType:"",setOtherCombo:function(a){return null},gridDblClick:function(a,d,b){var c=a.store.getAt(d);if(c!=null){this.setValue(c.get("modelCode"));this.setRawValue(c.get("modelCode"));if(!Ext.isEmpty(this.hiddenField)){this.hiddenField.value=c.get("modelCode")}if(this.setOtherField!=undefined){this.setOtherField(c)}}this.collapse()},getCol:function(){return["modelCode"]},getColTitle:function(){return[{header:"机型",dataIndex:"modelCode",width:120}]},getQryUrl:function(){return this.rootPath+"/basEquModelWeb.cll?method=getEquModel&qryType="+this.qryType},getPkField:function(){return"modelCode"}});Ext.reg("MachineModelBox",com.base.MachineModelBox);com.base.BomInfoBox=Ext.extend(Ext.ux.BaseGridBox,{bomStatus:"1020",setOtherCombo:function(a){return null},gridDblClick:function(a,d,b){var c=a.store.getAt(d);if(c!=null){this.setValue(c.get("keyid"));this.setRawValue(c.get("bomNo"));if(!Ext.isEmpty(this.hiddenField)){this.hiddenField.value=c.get("keyid")}if(this.setOtherField!=undefined){this.setOtherField(c)}}this.collapse()},getCol:function(){return["bomNo","keyid","goodNo","goodName","custNo","custName","bomType","joinNo","lengthVal","lenDf","widthVal","widthDf","widthEn"]},getColTitle:function(){return[{header:"BOM编码",dataIndex:"bomNo",width:100},{header:"产品名称",dataIndex:"goodName",width:160},{header:"产品编号",dataIndex:"goodNo",width:100},{header:"客户名称",dataIndex:"custName",width:120}]},getQryUrl:function(){return this.rootPath+"/bomWeb.cll?method=qryBomBox&bomStatus="+this.bomStatus},getPkField:function(){return"craftCode"}});Ext.reg("BomInfoBox",com.base.BomInfoBox);com.base.EquipBox=Ext.extend(Ext.ux.BaseGridBox,{splitNo:",",isSingleSel:true,setVal:function(a,b){this.setValue(a);this.setRawValue(b);if(this.hiddenField){this.hiddenField.value=a}},selFun:function(){var e=this.gridPnl.getSelectionModel().getSelections();var b=e.length;var c="",d="";for(var a=0;a<b;a++){c=c+e[a].get("equCode")+this.splitNo;d=d+e[a].get("equName")+this.splitNo}if(b>=1){c=c.substr(0,c.length-(this.splitNo).length);d=d.substr(0,d.length-(this.splitNo).length)}this.setVal(c,d);this.collapse()},setOtherCombo:function(a){return null},gridDblClick:function(a,d,b){var c=a.store.getAt(d);if(c!=null){this.setVal(c.get("equCode"),c.get("equName"));if(this.setOtherField!=undefined){this.setOtherField(c)}}this.collapse()},getCol:function(){return["equCode","equName","equType","equModel"]},getColTitle:function(){return[{header:"机台编号",dataIndex:"equCode"},{header:"机台名称",dataIndex:"equName",width:150}]},getQryUrl:function(){return this.rootPath+"/basEquipmentWeb.cll?method=getEqu"},getPkField:function(){return"equCode"}});Ext.reg("EquipBox",com.base.EquipBox);com.base.TeamBox=Ext.extend(Ext.ux.BaseGridBox,{setOtherCombo:function(a){return null},gridDblClick:function(a,d,b){var c=a.store.getAt(d);if(c!=null){this.setValue(c.get("value"));this.setRawValue(c.get("text"));if(!Ext.isEmpty(this.hiddenField)){this.hiddenField.value=c.get("value")}if(this.setOtherField!=undefined){this.setOtherField(c)}}this.collapse()},getCol:function(){return["text","value"]},getColTitle:function(){return[{width:100,header:"班组名称",dataIndex:"text"},{width:100,header:"班组编码",dataIndex:"value"}]},getQryUrl:function(){return this.rootPath+"/teamWeb.cll?method=getBasTeam"},getPkField:function(){return""}});Ext.reg("TeamBox",com.base.TeamBox);